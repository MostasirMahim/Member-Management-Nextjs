"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[207],{80207:function(e,t,a){a.d(t,{default:function(){return e_}});var s=a(57437),r=a(79820),l=a(2265),n=a(60610),i=a(93448);let o=l.forwardRef((e,t)=>{let{className:a,value:r,...l}=e;return(0,s.jsx)(n.fC,{ref:t,className:(0,i.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...l,children:(0,s.jsx)(n.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});o.displayName=n.fC.displayName;var d=a(69174),c=a(77314),u=a(34422),m=a(75060),h=a(40279),v=a(94589),p=a(12381),x=a(15291),f=a(18930),b=a(99397),y=a(10407),g=a(81500),j=a(88231),_=a(29827),N=a(21770),w=a(69417),C=a(99376),S=a(94242),A=a(23944);let F=u.Ry({contacts:u.IX().of(u.Ry({contact_type:u.Z_().required("Contact type is required"),number:u.Z_().required("Contact number is required"),is_primary:u.O7()})).min(1,"At least one contact is required")});function q(){(0,C.useRouter)();let e=(0,C.usePathname)(),t=null==e?void 0:e.startsWith("/member/update/"),{currentStep:a,setCurrentStep:r,nextStep:l,markStepCompleted:n,memberID:i,setMemberID:o}=(0,w.Xm)(),{data:d,isLoading:u}=(0,g.Z)(),{contact_type:q}=null!=d?d:{},{data:D,isLoading:k}=(0,A.Z)(i,{enabled:t&&!!i}),{contact_info:Z}=null!=D?D:{},E=(0,_.NL)(),{mutate:z,isPending:I}=(0,N.D)({mutationFn:async e=>(await j.Z.post("/api/member/v1/members/contact_numbers/",e)).data,onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(E.invalidateQueries({queryKey:["useGetMember",i]}),S.toast.success(e.message||"Contact has been successfully added."),M.resetForm(),n(a),l())},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="contacts.".concat(t,".").concat(a);M.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),{mutate:R,isPending:B}=(0,N.D)({mutationFn:async e=>(await j.Z.patch("/api/member/v1/members/contact_numbers/".concat(i,"/"),e)).data,onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(console.log(e),E.invalidateQueries({queryKey:["useGetMember",i]}),S.toast.success(e.message||"Contact successfully updated."))},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="contacts.".concat(t,".").concat(a);M.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),M=(0,c.TA)({enableReinitialize:!0,initialValues:t&&Z&&(null==Z?void 0:Z.length)>0?{contacts:null==Z?void 0:Z.map(e=>{var t;return{id:null==e?void 0:e.id,contact_type:(null===(t=e.contact_type)||void 0===t?void 0:t.id)||"",number:(null==e?void 0:e.number)||"",is_primary:(null==e?void 0:e.is_primary)||!1}})}:{contacts:[{contact_type:"",number:"",is_primary:!1}]},validationSchema:F,onSubmit:e=>{if(!i){S.toast.error("Member ID not found");return}let a={member_ID:i,data:e.contacts};t?R(a):z(a)}}),V=e=>{if(M.values.contacts.length>1){let t=M.values.contacts.filter((t,a)=>a!==e);M.setFieldValue("contacts",t)}else S.toast.error("At least one contact is required")},O=(e,t,a)=>{M.setFieldValue("contacts.".concat(e,".").concat(t),a)},P=()=>{l()},T=()=>{M.resetForm()};return(0,s.jsxs)("form",{onSubmit:M.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[M.values.contacts.map((e,t)=>{var a,r,l,n,i,o,d,c,u,b,y,g,j,_;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[M.values.contacts.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Contact ",t+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>V(t),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Contact Type"}),(0,s.jsxs)(x.Ph,{value:e.contact_type,onValueChange:e=>O(t,"contact_type",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"What kind of contact is this?",children:null!==(_=null==q?void 0:null===(a=q.find(t=>String(t.id)===String(e.contact_type)))||void 0===a?void 0:a.name)&&void 0!==_?_:"What kind of contact is this?"})}),(0,s.jsx)(x.Bw,{children:null==q?void 0:q.map((e,t)=>(0,s.jsx)(x.Ql,{value:e.id,children:e.name},t))})]}),(null===(l=M.touched.contacts)||void 0===l?void 0:null===(r=l[t])||void 0===r?void 0:r.contact_type)&&(null===(i=M.errors.contacts)||void 0===i?void 0:null===(n=i[t])||void 0===n?void 0:n.contact_type)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(d=M.errors.contacts)||void 0===d?void 0:null===(o=d[t])||void 0===o?void 0:o.contact_type})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Contact Number"}),(0,s.jsx)(h.I,{type:"tel",placeholder:"Enter contact number",value:e.number,onChange:e=>O(t,"number",e.target.value),onBlur:M.handleBlur,name:"contacts.".concat(t,".number"),className:"w-full"}),(null===(u=M.touched.contacts)||void 0===u?void 0:null===(c=u[t])||void 0===c?void 0:c.number)&&(null===(y=M.errors.contacts)||void 0===y?void 0:null===(b=y[t])||void 0===b?void 0:b.number)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(j=M.errors.contacts)||void 0===j?void 0:null===(g=j[t])||void 0===g?void 0:g.number})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(v.r,{checked:e.is_primary,onCheckedChange:e=>O(t,"is_primary",e),disabled:M.values.contacts.some((e,a)=>e.is_primary&&a!==t)}),(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Use as Primary"})]})]})]},t)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...M.values.contacts,{contact_type:"",number:"",is_primary:!1}];M.setFieldValue("contacts",e)},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>T(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>P(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:I||B,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[I||B?"Saving...":"Save & Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var D=a(46291),k=a(12749),Z=a(31047),E=a(32489),z=a(17689),I=a(52255);let R=u.Ry({member_ID:u.Z_().required("Member ID is required"),companion_name:u.Z_().required("Companion name is required"),companion_dob:u.hT().required("Companion date of birth is required"),companion_contact_number:u.Z_().required("Companion contact number is required"),companion_card_number:u.Z_().required("Companion card number is required"),relation_with_member:u.Z_().required("Relation with member is required"),companion_image:u.nK().nullable()});function B(){var e,t,a,r,n,o,d,u;let v=(0,l.useRef)(null);(0,C.useRouter)();let x=(0,_.NL)(),{currentStep:f,setCurrentStep:b,nextStep:g,markStepCompleted:F,memberID:q,setMemberID:B,isUpdateMode:M}=(0,w.Xm)(),{data:V,isLoading:O}=(0,A.Z)(q,{enabled:M&&!!q}),{companion:P}=null!=V?V:{},{mutate:T,isPending:L}=(0,N.D)({mutationFn:async e=>{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;t.append(a,s)}),(await j.Z.post("/api/member/v1/members/companion/",e,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(W.resetForm(),S.toast.success(e.message||"Companion has been successfully added."),F(f),g())},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if(s&&"object"==typeof s){for(let[e,t]of Object.entries(s))if(Array.isArray(t)&&t.length>0&&(W.setFieldError(e,t[0]),"member_ID"===e)){S.toast.error(t[0]);return}S.toast.error("Submission Failed")}else S.toast.error(r||a||"Submission Failed")}}),{mutate:Q,isPending:U}=(0,N.D)({mutationFn:async e=>{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;t.append(a,s)}),(await j.Z.patch("/api/member/v1/members/companion/",e,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(x.invalidateQueries({queryKey:["useGetMember",q]}),S.toast.success(e.message||"Companion updated."))},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if(s&&"object"==typeof s){for(let[e,t]of Object.entries(s))if(Array.isArray(t)&&t.length>0&&(W.setFieldError(e,t[0]),"member_ID"===e)){S.toast.error(t[0]);return}S.toast.error("Submission Failed")}else S.toast.error(r||a||"Submission Failed")}}),W=(0,c.TA)({enableReinitialize:!0,initialValues:M&&P&&(null==P?void 0:P.length)>0?{member_ID:q,id:(null===(e=P[0])||void 0===e?void 0:e.id)||0,companion_name:(null===(t=P[0])||void 0===t?void 0:t.companion_name)||"",companion_dob:(null===(a=P[0])||void 0===a?void 0:a.companion_dob)||null,companion_contact_number:(null===(r=P[0])||void 0===r?void 0:r.companion_contact_number)||"",companion_card_number:(null===(n=P[0])||void 0===n?void 0:n.companion_card_number)||"",relation_with_member:(null===(o=P[0])||void 0===o?void 0:o.relation_with_member)||"",companion_image:null}:{member_ID:q,companion_name:"",companion_dob:null,companion_contact_number:"",companion_card_number:"",relation_with_member:"",companion_image:null},validationSchema:R,onSubmit:e=>{if(!q){S.toast.error("No Member ID found.");return}M?Q(e):T(e)}}),K=(e,t)=>{W.setFieldValue(e,t)},X=()=>{g()},G=()=>{W.resetForm()};return(0,s.jsxs)("form",{onSubmit:W.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-1 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"companion_name",className:"text-sm font-medium text-gray-700",children:"Companion Name"}),(0,s.jsx)(h.I,{id:"companion_name",name:"companion_name",value:W.values.companion_name,onChange:W.handleChange,onBlur:W.handleBlur,placeholder:"Enter Companion Name",className:"w-full"}),W.touched.companion_name&&W.errors.companion_name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:W.errors.companion_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,s.jsxs)(k.J2,{children:[(0,s.jsx)(k.xo,{asChild:!0,children:(0,s.jsxs)(p.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!W.values.companion_dob&&"text-muted-foreground"),children:[(0,s.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),W.values.companion_dob?(0,I.WU)(W.values.companion_dob,"PPP"):"Select Date"]})}),(0,s.jsx)(k.yk,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(D.f,{mode:"single",captionLayout:"dropdown",selected:W.values.companion_dob?new Date(W.values.companion_dob):void 0,onSelect:e=>{e&&K("companion_dob",(0,I.WU)(e,"yyyy-MM-dd"))},initialFocus:!0})})]}),W.touched.companion_dob&&W.errors.companion_dob&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:W.errors.companion_dob})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"companion_contact_number",className:"text-sm font-medium text-gray-700",children:"Contact Number"}),(0,s.jsx)(h.I,{id:"companion_contact_number",name:"companion_contact_number",type:"tel",value:W.values.companion_contact_number,onChange:W.handleChange,onBlur:W.handleBlur,placeholder:"Enter Companion Contact",className:"w-full"}),W.touched.companion_contact_number&&W.errors.companion_contact_number&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:W.errors.companion_contact_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"companion_card_number",className:"text-sm font-medium text-gray-700",children:"Companion Card Number"}),(0,s.jsx)(h.I,{id:"companion_card_number",name:"companion_card_number",value:W.values.companion_card_number,onChange:W.handleChange,onBlur:W.handleBlur,placeholder:"Enter Companion Card Number",className:"w-full"}),W.touched.companion_card_number&&W.errors.companion_card_number&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:W.errors.companion_card_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"relation_with_member",className:"text-sm font-medium text-gray-700",children:"Relation with Member"}),(0,s.jsx)(h.I,{id:"relation_with_member",name:"relation_with_member",value:W.values.relation_with_member,onChange:W.handleChange,onBlur:W.handleBlur,placeholder:"Enter Relation with Member",className:"w-full"}),W.touched.relation_with_member&&W.errors.relation_with_member&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:W.errors.relation_with_member})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Companion Picture"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 pr-5",children:M?null===(u=P[0])||void 0===u?void 0:null===(d=u.companion_image)||void 0===d?void 0:d.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,s.jsx)("input",{ref:v,type:"file",accept:"image/*",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a?W.setFieldValue("companion_image",a):S.toast.error("No file selected")},className:"hidden"}),W.values.companion_image?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-700",children:W.values.companion_image.name}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{W.setFieldValue("companion_image",null),v.current&&(v.current.value="")},children:(0,s.jsx)(E.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(p.z,{type:"button",variant:"ghost",onClick:()=>{var e;null===(e=v.current)||void 0===e||e.click()},className:"w-full",children:[(0,s.jsx)(z.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>G(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>X(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:L||U,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[L||U?"Saving...":"Save & Next"," ",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let M=u.Ry({data:u.IX().of(u.Ry({contact_name:u.Z_().required("Contact name is required"),contact_number:u.Z_().required("Contact number is required"),relation_with_member:u.Z_().required("Relation with member is required")})).min(1,"At least one emergency contact is required")}),V={data:[{contact_name:"",contact_number:"",relation_with_member:""}]};function O(){(0,C.useRouter)();let e=(0,_.NL)(),{currentStep:t,setCurrentStep:a,nextStep:r,markStepCompleted:l,memberID:n,setMemberID:i,isUpdateMode:o}=(0,w.Xm)(),{data:d,isLoading:u}=(0,A.Z)(n,{enabled:o&&!!n}),{emergency_contact:v}=null!=d?d:{},{mutate:x,isPending:g}=(0,N.D)({mutationFn:async e=>(await j.Z.post("/api/member/v1/members/emergency_contact/",e)).data,onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(D.resetForm(),S.toast.success(e.message||"Emergency Contact has been successfully added."),l(t),r())},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);D.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),{mutate:F,isPending:q}=(0,N.D)({mutationFn:async e=>(await j.Z.patch("/api/member/v1/members/emergency_contact/".concat(n,"/"),e)).data,onSuccess:t=>{(null==t?void 0:t.status)==="success"&&(e.invalidateQueries({queryKey:["useGetMember",n]}),S.toast.success(t.message||"Emergency Contact has been successfully updated."))},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);D.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),D=(0,c.TA)({enableReinitialize:!0,initialValues:o&&v&&(null==v?void 0:v.length)>0?{data:null==v?void 0:v.map(e=>({id:(null==e?void 0:e.id)||0,contact_name:(null==e?void 0:e.contact_name)||"",contact_number:(null==e?void 0:e.contact_number)||"",relation_with_member:(null==e?void 0:e.relation_with_member)||""}))}:V,validationSchema:M,onSubmit:e=>{if(!n){S.toast.error("No Member ID found. Please start from member creation.");return}let t={member_ID:n,data:e.data};o?F(t):x(t)}}),k=e=>{if(D.values.data.length>1){let t=D.values.data.filter((t,a)=>a!==e);D.setFieldValue("data",t)}else S.toast.error("At least one emergency contact is required")},Z=(e,t,a)=>{D.setFieldValue("data.".concat(e,".").concat(t),a)},E=()=>{r()},z=()=>{D.resetForm()};return(0,s.jsxs)("form",{onSubmit:D.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[D.values.data.map((e,t)=>{var a,r,l,n,i,o,d,c,u,v,x,b,y,g,j,_,N,w;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[D.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Emergency Contact ",t+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(t),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Contact Name"}),(0,s.jsx)(h.I,{placeholder:"Enter Emergency Contact Name",value:e.contact_name,onChange:e=>Z(t,"contact_name",e.target.value),onBlur:D.handleBlur,name:"data.".concat(t,".contact_name"),className:"w-full"}),(null===(r=D.touched.data)||void 0===r?void 0:null===(a=r[t])||void 0===a?void 0:a.contact_name)&&(null===(n=D.errors.data)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l.contact_name)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(o=D.errors.data)||void 0===o?void 0:null===(i=o[t])||void 0===i?void 0:i.contact_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Contact Number"}),(0,s.jsx)(h.I,{type:"tel",placeholder:"Enter Emergency Contact",value:e.contact_number,onChange:e=>Z(t,"contact_number",e.target.value),onBlur:D.handleBlur,name:"data.".concat(t,".contact_number"),className:"w-full"}),(null===(c=D.touched.data)||void 0===c?void 0:null===(d=c[t])||void 0===d?void 0:d.contact_number)&&(null===(v=D.errors.data)||void 0===v?void 0:null===(u=v[t])||void 0===u?void 0:u.contact_number)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(b=D.errors.data)||void 0===b?void 0:null===(x=b[t])||void 0===x?void 0:x.contact_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Relation With Member"}),(0,s.jsx)(h.I,{placeholder:"Enter Relation With Member",value:e.relation_with_member,onChange:e=>Z(t,"relation_with_member",e.target.value),onBlur:D.handleBlur,name:"data.".concat(t,".relation_with_member"),className:"w-full"}),(null===(g=D.touched.data)||void 0===g?void 0:null===(y=g[t])||void 0===y?void 0:y.relation_with_member)&&(null===(_=D.errors.data)||void 0===_?void 0:null===(j=_[t])||void 0===j?void 0:j.relation_with_member)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(w=D.errors.data)||void 0===w?void 0:null===(N=w[t])||void 0===N?void 0:N.relation_with_member})]})]})]},t)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...D.values.data,{contact_name:"",contact_number:"",relation_with_member:""}];D.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>z(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>E(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:g||q,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[g||q?"Saving...":"Save & Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let P=u.Ry({data:u.IX().of(u.Ry({member_ID:u.Z_().required("Member ID is required"),title:u.Z_().required("Certificate title is required"),certificate_document:u.nK().required("Certificate document is required"),certificate_number:u.Z_().required("Certificate number is required")})).min(1,"At least one certificate is required")});function T(){let e=(0,l.useRef)([]);(0,C.useRouter)();let t=(0,_.NL)(),{currentStep:a,setCurrentStep:r,nextStep:n,markStepCompleted:i,memberID:o,setMemberID:d,isUpdateMode:u}=(0,w.Xm)(),{data:v,isLoading:x}=(0,A.Z)(o,{enabled:u&&!!o}),{certificate:g}=null!=v?v:{},{mutate:F,isPending:q}=(0,N.D)({mutationFn:async e=>{let t={},a=await Promise.allSettled(e.map(async(e,a)=>{try{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;s instanceof File||s instanceof Blob?t.append(a,s):"boolean"==typeof s||"number"==typeof s?t.append(a,String(s)):null!=s&&t.append(a,s)}),(await j.Z.post("/api/member/v1/members/certificate/",t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(l){var s,r;let{errors:e}=(null==l?void 0:null===(s=l.response)||void 0===s?void 0:s.data)||{};if(console.log(null==l?void 0:null===(r=l.response)||void 0===r?void 0:r.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(t["data.".concat(a,".").concat(s)]=r[0]);return null}}));Object.entries(t).forEach(e=>{let[t,a]=e;Z.setFieldError(t,a)});let s=a.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(a.some(e=>"rejected"===e.status||null===e.value))throw Error("Some certificates failed to submit.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(Z.resetForm(),S.toast.success("All Certificates have been successfully added."),i(a),n())},onError:e=>{console.error("Certificate submit error:",e),S.toast.error((null==e?void 0:e.message)||"Some certificates failed to submit.")}}),{mutate:D,isPending:k}=(0,N.D)({mutationFn:async e=>{let t={},a=await Promise.allSettled(e.map(async(e,a)=>{try{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;s instanceof File||s instanceof Blob?t.append(a,s):"boolean"==typeof s||"number"==typeof s?t.append(a,String(s)):null!=s&&t.append(a,s)}),(await j.Z.patch("/api/member/v1/members/certificate/",t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(l){var s,r;let{errors:e}=(null==l?void 0:null===(s=l.response)||void 0===s?void 0:s.data)||{};if(console.log(null==l?void 0:null===(r=l.response)||void 0===r?void 0:r.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(t["data.".concat(a,".").concat(s)]=r[0]);return null}}));Object.entries(t).forEach(e=>{let[t,a]=e;Z.setFieldError(t,a)});let s=a.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(a.some(e=>"rejected"===e.status||null===e.value))throw Error("Some certificates failed to update.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(t.invalidateQueries({queryKey:["useGetMember",o]}),S.toast.success("All Certificate updated."))},onError:e=>{console.error("Certificate update error:",e),S.toast.error((null==e?void 0:e.message)||"Some certificates failed to update.")}}),Z=(0,c.TA)({enableReinitialize:!0,initialValues:u&&g&&(null==g?void 0:g.length)>0?{data:null==g?void 0:g.map(e=>({id:(null==e?void 0:e.id)||0,member_ID:o,title:(null==e?void 0:e.title)||"",certificate_document:null,certificate_number:(null==e?void 0:e.certificate_number)||""}))}:{data:[{member_ID:o,title:"",certificate_document:null,certificate_number:""}]},validationSchema:P,onSubmit:e=>{if(!o){S.toast.error("Member ID not found");return}u?D(e.data):F(e.data)}}),I=e=>{if(Z.values.data.length>1){let t=Z.values.data.filter((t,a)=>a!==e);Z.setFieldValue("data",t)}else S.toast.error("At least one certificate is required")},R=(e,t,a)=>{Z.setFieldValue("data.".concat(e,".").concat(t),a)},B=(e,t)=>{var a;let s=null===(a=t.target.files)||void 0===a?void 0:a[0];s?R(e,"certificate_document",s):S.toast.error("No file selected")},M=t=>{R(t,"certificate_document",null),e.current[t]&&(e.current[t].value="")},V=()=>{n()},O=()=>{Z.resetForm()};return(0,s.jsxs)("form",{onSubmit:Z.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[Z.values.data.map((t,a)=>{var r,l,n,i,o,d,c,v,x,b,y,j,_,N,w,C,S,A,F,q;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[Z.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Certificate ",a+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>I(a),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Certificate Title"}),(0,s.jsx)(h.I,{placeholder:"Enter Certificate Title",value:t.title,onChange:e=>R(a,"title",e.target.value),onBlur:Z.handleBlur,name:"data.".concat(a,".title"),className:"w-full"}),(null===(l=Z.touched.data)||void 0===l?void 0:null===(r=l[a])||void 0===r?void 0:r.title)&&(null===(i=Z.errors.data)||void 0===i?void 0:null===(n=i[a])||void 0===n?void 0:n.title)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(d=Z.errors.data)||void 0===d?void 0:null===(o=d[a])||void 0===o?void 0:o.title})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Upload Certificate"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 pr-5",children:u?null===(v=g[a])||void 0===v?void 0:null===(c=v.certificate_document)||void 0===c?void 0:c.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,s.jsx)("input",{ref:t=>{e.current[a]=t},type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:e=>B(a,e),className:"hidden"}),t.certificate_document?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-700",children:t.certificate_document.name}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>M(a),children:(0,s.jsx)(E.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(p.z,{type:"button",variant:"ghost",onClick:()=>{var t;null===(t=e.current[a])||void 0===t||t.click(),console.log("Clicked to upload certificate ".concat(a," file"))},className:"w-full",children:[(0,s.jsx)(z.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),(null===(b=Z.touched.data)||void 0===b?void 0:null===(x=b[a])||void 0===x?void 0:x.certificate_document)&&(null===(j=Z.errors.data)||void 0===j?void 0:null===(y=j[a])||void 0===y?void 0:y.certificate_document)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(N=Z.errors.data)||void 0===N?void 0:null===(_=N[a])||void 0===_?void 0:_.certificate_document})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Certificate Number"}),(0,s.jsx)(h.I,{placeholder:"Enter Certificate Number",value:t.certificate_number,onChange:e=>R(a,"certificate_number",e.target.value),onBlur:Z.handleBlur,name:"data.".concat(a,".certificate_number"),className:"w-full"}),(null===(C=Z.touched.data)||void 0===C?void 0:null===(w=C[a])||void 0===w?void 0:w.certificate_number)&&(null===(A=Z.errors.data)||void 0===A?void 0:null===(S=A[a])||void 0===S?void 0:S.certificate_number)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(q=Z.errors.data)||void 0===q?void 0:null===(F=q[a])||void 0===F?void 0:F.certificate_number})]})]})]},a)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...Z.values.data,{member_ID:o,title:"",certificate_document:null,certificate_number:""}];Z.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>O(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>V(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:q||k,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[q||k?"Saving...":"Save & Next"," ",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let L=u.Ry({data:u.IX().of(u.Ry({member_ID:u.Z_().required("Member ID is required"),document_document:u.nK().required("Document file is required"),document_type:u.Z_().required("Document type is required")})).min(1,"At least one document is required")});function Q(){let e=(0,l.useRef)([]);(0,C.useRouter)();let t=(0,_.NL)(),{currentStep:a,setCurrentStep:r,nextStep:n,markStepCompleted:i,memberID:o,setMemberID:d,isUpdateMode:u}=(0,w.Xm)(),{data:h,isLoading:v}=(0,A.Z)(o,{enabled:u&&!!o}),{document:F}=null!=h?h:{},{data:q,isLoading:D}=(0,g.Z)(),{document_type:k}=null!=q?q:{},{mutate:Z,isPending:I}=(0,N.D)({mutationFn:async e=>{let t={},a=await Promise.allSettled(e.map(async(e,a)=>{try{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;s instanceof File||s instanceof Blob?t.append(a,s):"boolean"==typeof s||"number"==typeof s?t.append(a,String(s)):null!=s&&t.append(a,s)}),(await j.Z.post("/api/member/v1/members/documents/",t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(l){var s,r;let{errors:e}=(null==l?void 0:null===(s=l.response)||void 0===s?void 0:s.data)||{};if(console.log(null==l?void 0:null===(r=l.response)||void 0===r?void 0:r.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(t["data.".concat(a,".").concat(s)]=r[0]);return null}}));Object.entries(t).forEach(e=>{let[t,a]=e;M.setFieldError(t,a)});let s=a.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(a.some(e=>"rejected"===e.status||null===e.value))throw Error("Some documents failed to upload.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(M.resetForm(),S.toast.success("All document successfully added."),i(a),n())},onError:e=>{console.error("Documents submit error:",e),S.toast.error((null==e?void 0:e.message)||"Some documents failed to submit.")}}),{mutate:R,isPending:B}=(0,N.D)({mutationFn:async e=>{let t={},a=await Promise.allSettled(e.map(async(e,a)=>{try{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;s instanceof File||s instanceof Blob?t.append(a,s):"boolean"==typeof s||"number"==typeof s?t.append(a,String(s)):null!=s&&t.append(a,s)}),(await j.Z.patch("/api/member/v1/members/documents/",t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(l){var s,r;let{errors:e}=(null==l?void 0:null===(s=l.response)||void 0===s?void 0:s.data)||{};if(console.log(null==l?void 0:null===(r=l.response)||void 0===r?void 0:r.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(t["data.".concat(a,".").concat(s)]=r[0]);return null}}));Object.entries(t).forEach(e=>{let[t,a]=e;M.setFieldError(t,a)});let s=a.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(a.some(e=>"rejected"===e.status||null===e.value))throw Error("Some documents failed to update.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(t.invalidateQueries({queryKey:["useGetMember",o]}),S.toast.success("All document updated."))},onError:e=>{console.error("Documents update error:",e),S.toast.error((null==e?void 0:e.message)||"Some documents failed to update.")}}),M=(0,c.TA)({enableReinitialize:!0,initialValues:u&&F&&(null==F?void 0:F.length)>0?{data:null==F?void 0:F.map(e=>{var t,a;return{id:(null==e?void 0:e.id)||0,member_ID:o,document_document:null,document_type:(null==e?void 0:null===(a=e.document_type)||void 0===a?void 0:null===(t=a.id)||void 0===t?void 0:t.toString())||""}})}:{data:[{member_ID:o,document_document:null,document_type:""}]},validationSchema:L,onSubmit:e=>{if(!o){S.toast.error("Member ID not found");return}u?R(e.data):Z(e.data)}}),V=e=>{if(M.values.data.length>1){let t=M.values.data.filter((t,a)=>a!==e);M.setFieldValue("data",t)}else S.toast.error("At least one document is required")},O=(e,t,a)=>{M.setFieldValue("data.".concat(e,".").concat(t),a)},P=(e,t)=>{var a;let s=null===(a=t.target.files)||void 0===a?void 0:a[0];s&&O(e,"document_document",s)},T=()=>{n()},Q=()=>{M.resetForm()};return(0,s.jsxs)("form",{onSubmit:M.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[M.values.data.map((t,a)=>{var r,l,n,i,o,d,c,h,v,b,y,g,j,_,N,w;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[M.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Document ",a+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>V(a),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Upload Document"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 pr-5",children:u?null===(l=F[a])||void 0===l?void 0:null===(r=l.document_document)||void 0===r?void 0:r.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,s.jsx)("input",{ref:t=>{e.current[a]=t},type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:e=>P(a,e),className:"hidden"}),t.document_document?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-700",children:t.document_document.name}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{O(a,"document_document",null),console.log("Removed document ".concat(a," file"))},children:(0,s.jsx)(E.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(p.z,{type:"button",variant:"ghost",onClick:()=>{var t;null===(t=e.current[a])||void 0===t||t.click(),console.log("Clicked to upload document ".concat(a," file"))},className:"w-full",children:[(0,s.jsx)(z.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),(null===(i=M.touched.data)||void 0===i?void 0:null===(n=i[a])||void 0===n?void 0:n.document_document)&&(null===(d=M.errors.data)||void 0===d?void 0:null===(o=d[a])||void 0===o?void 0:o.document_document)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(h=M.errors.data)||void 0===h?void 0:null===(c=h[a])||void 0===c?void 0:c.document_document})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Select Document Type"}),(0,s.jsxs)(x.Ph,{value:t.document_type,onValueChange:e=>O(a,"document_type",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"What kind of document is this?",children:null!==(w=null==k?void 0:null===(v=k.find(e=>String(e.id)===String(t.document_type)))||void 0===v?void 0:v.name)&&void 0!==w?w:"What kind of document is this?"})}),(0,s.jsx)(x.Bw,{children:null==k?void 0:k.map(e=>(0,s.jsx)(x.Ql,{value:e.id,children:e.name},e.id))})]}),(null===(y=M.touched.data)||void 0===y?void 0:null===(b=y[a])||void 0===b?void 0:b.document_type)&&(null===(j=M.errors.data)||void 0===j?void 0:null===(g=j[a])||void 0===g?void 0:g.document_type)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(N=M.errors.data)||void 0===N?void 0:null===(_=N[a])||void 0===_?void 0:_.document_type})]})]})]},a)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...M.values.data,{member_ID:o,document_document:null,document_type:""}];M.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>Q(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>T(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:I||B,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[I||B?"Saving...":"Save & Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var U=a(54761);let W=u.Ry({data:u.IX().of(u.Ry({email_type:u.Rx().required("Email type is required"),email:u.Z_().email("Invalid email format").required("Email address is required"),is_primary:u.O7()})).min(1,"At least one email is required")}),K={data:[{email_type:null,email:"",is_primary:!1}]};function X(){(0,C.useRouter)();let e=(0,_.NL)(),{currentStep:t,setCurrentStep:a,nextStep:r,markStepCompleted:l,memberID:n,setMemberID:i,isUpdateMode:o}=(0,w.Xm)(),{data:d,isLoading:u}=(0,g.Z)(),{email_type:F}=null!=d?d:{},{data:q,isLoading:D}=(0,A.Z)(n,{enabled:o&&!!n}),{email_address:k}=null!=q?q:{},{mutate:Z,isPending:E}=(0,N.D)({mutationFn:async e=>(await j.Z.post("/api/member/v1/members/email_address/",e)).data,onSuccess:a=>{(null==a?void 0:a.status)==="success"&&(e.invalidateQueries({queryKey:["useGetMember",n]}),S.toast.success(a.message||"Email has been successfully added."),l(t),r(),R.resetForm())},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);R.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),{mutate:z,isPending:I}=(0,N.D)({mutationFn:async e=>(await j.Z.patch("/api/member/v1/members/email_address/".concat(n,"/"),e)).data,onSuccess:t=>{(null==t?void 0:t.status)==="success"&&(e.invalidateQueries({queryKey:["useGetMember",n]}),S.toast.success(t.message||"Email successfully updated."))},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);R.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),R=(0,c.TA)({enableReinitialize:!0,initialValues:o&&k&&(null==k?void 0:k.length)>0?{data:null==k?void 0:k.map(e=>({id:(null==e?void 0:e.id)||0,email_type:(null==e?void 0:e.email_type.id)||null,email:(null==e?void 0:e.email)||"",is_primary:(null==e?void 0:e.is_primary)||!1}))}:K,validationSchema:W,onSubmit:e=>{if(!n){S.toast.error("No Member ID found. Please start from member creation.");return}let t={member_ID:n,data:e.data};o?z(t):Z(t)}}),B=e=>{R.values.data.length>1?R.setFieldValue("data",R.values.data.filter((t,a)=>a!==e)):S.toast.error("At least one email is required")},M=(e,t,a)=>{"is_primary"===t&&!0===a?R.setFieldValue("data",R.values.data.map((t,a)=>({...t,is_primary:a===e}))):R.setFieldValue("data.".concat(e,".").concat(t),a)};return u||D?(0,s.jsx)(U.Wo,{}):(0,s.jsxs)("form",{onSubmit:R.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[R.values.data.map((e,t)=>{var a,r,l,n,i,o,d,c,u,b,y,g,j,_;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[R.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Email ",t+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>B(t),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Email Type"}),(0,s.jsxs)(x.Ph,{value:e.email_type,onValueChange:e=>M(t,"email_type",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"What kind of Email is this?",children:null!==(_=null==F?void 0:null===(a=F.find(t=>String(t.id)===String(e.email_type)))||void 0===a?void 0:a.name)&&void 0!==_?_:"Select email type"})}),(0,s.jsx)(x.Bw,{children:null==F?void 0:F.map((e,t)=>(0,s.jsx)(x.Ql,{value:e.id,children:e.name},t))})]}),(null===(l=R.touched.data)||void 0===l?void 0:null===(r=l[t])||void 0===r?void 0:r.email_type)&&(null===(i=R.errors.data)||void 0===i?void 0:null===(n=i[t])||void 0===n?void 0:n.email_type)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(d=R.errors.data)||void 0===d?void 0:null===(o=d[t])||void 0===o?void 0:o.email_type})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Email Address"}),(0,s.jsx)(h.I,{type:"email",placeholder:"Enter email address",value:e.email,onChange:e=>M(t,"email",e.target.value),onBlur:R.handleBlur,name:"data.".concat(t,".email"),className:"w-full"}),(null===(u=R.touched.data)||void 0===u?void 0:null===(c=u[t])||void 0===c?void 0:c.email)&&(null===(y=R.errors.data)||void 0===y?void 0:null===(b=y[t])||void 0===b?void 0:b.email)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(j=R.errors.data)||void 0===j?void 0:null===(g=j[t])||void 0===g?void 0:g.email})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(v.r,{checked:e.is_primary,onCheckedChange:e=>M(t,"is_primary",e)}),(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Use as Primary"})]})]})]},t)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{R.setFieldValue("data",[...R.values.data,{email_type:null,email:"",is_primary:!1}])},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4"}),"Add Emails"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>{R.resetForm()},className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>{r()},className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:E||I,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[E||I?"Saving...":"Save & Next"," ",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var G=a(23675);let J=u.Ry({data:u.IX().of(u.Ry({address_type:u.Rx().required("Address type is required"),address:u.Z_().required("Address is required"),is_primary:u.O7()})).min(1,"At least one address is required")}),Y={data:[{address_type:"",address:"",is_primary:!1}]};function H(){(0,C.useRouter)();let{currentStep:e,setCurrentStep:t,nextStep:a,markStepCompleted:r,memberID:l,setMemberID:n,isUpdateMode:i}=(0,w.Xm)(),{data:o}=(0,g.Z)(),{address_type:d}=null!=o?o:{},u=(0,_.NL)(),{data:h,isLoading:F}=(0,A.Z)(l,{enabled:i&&!!l}),{address:q}=null!=h?h:{},{mutate:D,isPending:k}=(0,N.D)({mutationFn:async e=>(await j.Z.post("/api/member/v1/members/address/",e)).data,onSuccess:t=>{(null==t?void 0:t.status)==="success"&&(I.resetForm(),S.toast.success(t.message||"Address has been successfully added."),r(e),a())},onError:z}),{mutate:Z,isPending:E}=(0,N.D)({mutationFn:async e=>(await j.Z.patch("/api/member/v1/members/address/".concat(l,"/"),e)).data,onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(S.toast.success(e.message||"Address has been successfully updated."),u.invalidateQueries({queryKey:["useGetMember",l]}))},onError:z});function z(e){var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);I.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}let I=(0,c.TA)({enableReinitialize:!0,initialValues:i&&q&&(null==q?void 0:q.length)>0?{data:null==q?void 0:q.map(e=>({id:e.id||0,address_type:e.address_type.id||0,address:e.address||"",is_primary:e.is_primary||!1}))}:Y,validationSchema:J,onSubmit:e=>{if(!l){S.toast.error("No Member ID found.");return}let t={member_ID:l,data:e.data};i?Z(t):D(t)}}),R=e=>{I.values.data.length>1?I.setFieldValue("data",I.values.data.filter((t,a)=>a!==e)):S.toast.error("At least one address is required")},B=(e,t,a)=>{"is_primary"===t&&!0===a?I.setFieldValue("data",I.values.data.map((t,a)=>({...t,is_primary:a===e}))):I.setFieldValue("data.".concat(e,".").concat(t),a)};return(0,s.jsxs)("form",{onSubmit:I.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[I.values.data.map((e,t)=>{var a,r,l,n,i,o,c,u,h,b,y,g,j,_;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[I.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Address ",t+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(t),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{children:"Address Type"}),(0,s.jsxs)(x.Ph,{value:String(e.address_type),onValueChange:e=>B(t,"address_type",e),children:[(0,s.jsx)(x.i4,{children:(0,s.jsx)(x.ki,{placeholder:"What kind of Address is this?",children:null!==(_=null==d?void 0:null===(a=d.find(t=>String(t.id)===String(e.address_type)))||void 0===a?void 0:a.name)&&void 0!==_?_:"Select address type"})}),(0,s.jsx)(x.Bw,{children:null==d?void 0:d.map(e=>(0,s.jsx)(x.Ql,{value:String(e.id),children:e.name},e.id))})]}),(null===(l=I.touched.data)||void 0===l?void 0:null===(r=l[t])||void 0===r?void 0:r.address_type)&&(null===(i=I.errors.data)||void 0===i?void 0:null===(n=i[t])||void 0===n?void 0:n.address_type)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(c=I.errors.data)||void 0===c?void 0:null===(o=c[t])||void 0===o?void 0:o.address_type})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{children:"Address"}),(0,s.jsx)(G.g,{placeholder:"Enter full address",value:e.address,onChange:e=>B(t,"address",e.target.value),onBlur:I.handleBlur,name:"data.".concat(t,".address")}),(null===(h=I.touched.data)||void 0===h?void 0:null===(u=h[t])||void 0===u?void 0:u.address)&&(null===(y=I.errors.data)||void 0===y?void 0:null===(b=y[t])||void 0===b?void 0:b.address)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(j=I.errors.data)||void 0===j?void 0:null===(g=j[t])||void 0===g?void 0:g.address})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(v.r,{checked:e.is_primary,onCheckedChange:e=>B(t,"is_primary",e)}),(0,s.jsx)(m._,{children:"Use as Primary"})]})]})]},t)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{I.setFieldValue("data",[...I.values.data,{address_type:"",address:"",is_primary:!1}])},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4"}),"Add Addresses"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>{I.resetForm()},className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>a(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:k||E,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[k||E?"Saving...":"Save & Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let $=u.Ry({spouse_name:u.Z_().required("Spouse name is required"),contact_number:u.Z_().required("Contact number is required"),spouse_dob:u.hT().required("Spouse date of birth is required"),image:u.nK().nullable().required("Profile picture is required"),current_status:u.Z_().required("Current status is required")}),ee=u.Ry({spouse_name:u.Z_().required("Spouse name is required"),contact_number:u.Z_().required("Contact number is required"),spouse_dob:u.hT().required("Spouse date of birth is required"),image:u.nK().nullable(),current_status:u.Z_().required("Current status is required")}),et={member_ID:"",spouse_name:"",contact_number:"",spouse_dob:null,image:null,current_status:""};function ea(){var e,t,a,r,n,o,d,u,v;let f=(0,l.useRef)(null);(0,C.useRouter)();let b=(0,_.NL)(),{currentStep:F,setCurrentStep:q,nextStep:R,markStepCompleted:B,memberID:M,setMemberID:V,isUpdateMode:O}=(0,w.Xm)(),{data:P,isLoading:T}=(0,A.Z)(M,{enabled:O&&!!M}),{spouse:L}=null!=P?P:{},{data:Q,isLoading:W}=(0,g.Z)(),{spouse_status_choice:K}=null!=Q?Q:{},{mutate:X,isPending:G}=(0,N.D)({mutationFn:async e=>{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;null!=s&&t.append(a,s)}),(await j.Z.post("/api/member/v1/members/spouse/",e,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(S.toast.success(e.message||"Spouse has been successfully added."),B(F),R())},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if(s&&"object"==typeof s){for(let[e,t]of Object.entries(s))Array.isArray(t)&&t.length>0&&H.setFieldError(e,t[0]);S.toast.error("Submission Failed")}else S.toast.error(r||a||"Submission Failed")}}),{mutate:J,isPending:Y}=(0,N.D)({mutationFn:async e=>{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;t.append(a,s)}),(await j.Z.patch("/api/member/v1/members/spouse/",e,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(b.invalidateQueries({queryKey:["useGetMember",M]}),S.toast.success(e.message||"Spouse has been successfully updated."))},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if(s&&"object"==typeof s){for(let[e,t]of Object.entries(s))Array.isArray(t)&&t.length>0&&H.setFieldError(e,t[0]);S.toast.error("Submission Failed")}else S.toast.error(r||a||"Submission Failed")}}),H=(0,c.TA)({enableReinitialize:!0,initialValues:O&&L&&(null==L?void 0:L.length)>0?{member_ID:M||"",id:(null===(e=L[0])||void 0===e?void 0:e.id)||0,spouse_name:(null===(t=L[0])||void 0===t?void 0:t.spouse_name)||"",contact_number:(null===(a=L[0])||void 0===a?void 0:a.spouse_contact_number)||"",spouse_dob:(null===(r=L[0])||void 0===r?void 0:r.spouse_dob)||null,image:null,current_status:(null===(o=L[0])||void 0===o?void 0:null===(n=o.current_status)||void 0===n?void 0:n.toString())||""}:et,validationSchema:O?ee:$,onSubmit:e=>{if(!M){S.toast.error("No Member ID found.");return}e.member_ID=M,e.member_ID&&(O?J(e):X(e))}}),ea=(e,t)=>{H.setFieldValue(e,t)},es=()=>{R()},er=()=>{H.resetForm()};return W||T?(0,s.jsx)(U.Wo,{}):(0,s.jsxs)("form",{onSubmit:H.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"spouse_name",className:"text-sm font-medium text-gray-700",children:"Spouse Name"}),(0,s.jsx)(h.I,{id:"spouse_name",name:"spouse_name",value:H.values.spouse_name,onChange:H.handleChange,onBlur:H.handleBlur,placeholder:"Enter Spouse Name",className:"w-full"}),H.errors.spouse_name&&H.touched.spouse_name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:H.errors.spouse_name})]}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"contact_number",className:"text-sm font-medium text-gray-700",children:"Contact Number"}),(0,s.jsx)(h.I,{id:"contact_number",name:"contact_number",type:"tel",value:H.values.contact_number,onChange:H.handleChange,onBlur:H.handleBlur,placeholder:"Enter Spouse Contact",className:"w-full"}),H.errors.contact_number&&H.touched.contact_number&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:H.errors.contact_number})]})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-1 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,s.jsxs)(k.J2,{children:[(0,s.jsx)(k.xo,{asChild:!0,children:(0,s.jsxs)(p.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!H.values.spouse_dob&&"text-muted-foreground"),children:[(0,s.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),H.values.spouse_dob?(0,I.WU)(H.values.spouse_dob,"PPP"):"Select Date"]})}),(0,s.jsx)(k.yk,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(D.f,{mode:"single",captionLayout:"dropdown",selected:H.values.spouse_dob?new Date(H.values.spouse_dob):void 0,onSelect:e=>{if(e){let t=(0,I.WU)(e,"yyyy-MM-dd");H.setFieldValue("spouse_dob",t)}},initialFocus:!0})})]}),H.errors.spouse_dob&&H.touched.spouse_dob&&"string"==typeof H.errors.spouse_dob&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:H.errors.spouse_dob})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Status"}),(0,s.jsxs)(x.Ph,{value:H.values.current_status,onValueChange:e=>ea("current_status",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"What is the spouse status?",children:null==K?void 0:null===(d=K.find(e=>String(e.id)===String(H.values.current_status)))||void 0===d?void 0:d.name})}),(0,s.jsx)(x.Bw,{children:null==K?void 0:K.map(e=>(0,s.jsx)(x.Ql,{value:e.id,children:e.name},e.id))})]}),H.errors.current_status&&H.touched.current_status&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:H.errors.current_status})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Spouse Picture"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 pr-5",children:O?null===(v=L[0])||void 0===v?void 0:null===(u=v.image)||void 0===u?void 0:u.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,s.jsx)("input",{ref:f,type:"file",accept:"image/*",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a?H.setFieldValue("image",a):S.toast.error("No file selected")},className:"hidden"}),H.values.image?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-700",children:H.values.image.name}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{ea("image",null)},children:(0,s.jsx)(E.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(p.z,{type:"button",variant:"ghost",onClick:()=>{var e;null===(e=f.current)||void 0===e||e.click()},className:"w-full",children:[(0,s.jsx)(z.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>er(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>es(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:G||Y,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[G||Y?"Saving...":"Save & Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var es=a(80225);let er=u.Ry({member_ID:u.Z_().required("Member ID is required"),first_name:u.Z_().required("First name is required"),last_name:u.Z_(),gender:u.Z_().required("Gender is required"),date_of_birth:u.hT().required("Date of birth is required"),institute_name:u.Z_().required("Institute name is required"),batch_number:u.Z_().required("Batch number is required"),membership_status:u.Z_().required("Membership status is required"),membership_type:u.Z_().required("Membership type is required"),marital_status:u.Z_().required("Marital status is required"),anniversary_date:u.hT().nullable().required("Anniversary date is required"),profile_photo:u.nK().required("Profile picture is required"),blood_group:u.Z_().required("Blood group is required"),nationality:u.Z_().required("Nationality is required")}),el=u.Ry({member_ID:u.Z_().required("Member ID is required"),first_name:u.Z_().required("First name is required"),last_name:u.Z_(),gender:u.Z_().required("Gender is required"),date_of_birth:u.hT().required("Date of birth is required"),institute_name:u.Z_().required("Institute name is required"),batch_number:u.Z_().required("Batch number is required"),membership_status:u.Z_().required("Membership status is required"),membership_type:u.Z_().required("Membership type is required"),marital_status:u.Z_().required("Marital status is required"),anniversary_date:u.hT().nullable().required("Anniversary date is required"),profile_photo:u.nK().nullable(),blood_group:u.Z_().required("Blood group is required"),nationality:u.Z_().required("Nationality is required")});function en(){var e,t,a,r,n,o,d,u;(0,C.useRouter)();let v=(0,es.e3)(),{currentStep:f,setCurrentStep:b,nextStep:F,markStepCompleted:q,setMemberID:R,memberID:B,isUpdateMode:M}=(0,w.Xm)(),V=(0,_.NL)(),{data:O,isLoading:P}=(0,g.Z)(),{data:T,isLoading:L}=(0,A.Z)(B,{enabled:M&&!!B}),{member_info:Q}=null!=T?T:{};console.log("memberData",Q);let{membership_type:W,institute_name:K,gender:X,membership_status:G,marital_status:J}=null!=O?O:{},{mutate:Y,isPending:H}=(0,N.D)({mutationFn:async e=>(await j.Z.post("/api/member/v1/members/get_latest_id/",e)).data,onSuccess:e=>{if((null==e?void 0:e.status)==="success"){var t;let a=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.next_available;a&&(en.setFieldValue("member_ID",a),R(a)),S.toast.success("Member ID added successfully")}},onError:e=>{console.log("error",null==e?void 0:e.response);let{message:t,errors:a,detail:s}=null==e?void 0:e.response.data;a?a&&"object"==typeof a&&(Object.entries(a).forEach(e=>{let[t,a]=e;Array.isArray(a)&&en.setFieldError(t,a[0])}),S.toast.error(s||t||"Generate ID Failed")):S.toast.error(s||t||"Generate ID Failed")}}),{mutate:$,isPending:ee}=(0,N.D)({mutationFn:async e=>{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;t.append(a,s)}),(await j.Z.post("/api/member/v1/members/",t,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(V.invalidateQueries({queryKey:["useGetMember",B]}),S.toast.success(e.message||"Membership has been successfully added."),q(f),F())},onError:e=>{console.log("error",null==e?void 0:e.response);let{message:t,errors:a,detail:s}=null==e?void 0:e.response.data;console.log(a),a&&"object"==typeof a?(Object.entries(a).forEach(e=>{let[t,a]=e;Array.isArray(a)&&en.setFieldError(t,a[0])}),S.toast.error(t||s||"Validation failed.")):S.toast.error(s||t||"An error occurred during submission.")}}),{mutate:et,isPending:ea}=(0,N.D)({mutationFn:async e=>{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;null!=s&&t.append(a,s)}),(await j.Z.patch("/api/member/v1/members/".concat(B,"/"),t,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(Promise.all([V.invalidateQueries({queryKey:["useGetMember",B]}),V.invalidateQueries({queryKey:["getAllMembers",1,2]})]),S.toast.success(e.message||"Membership Updated Successfully."))},onError:e=>{console.log("error",null==e?void 0:e.response);let{message:t,errors:a,detail:s}=null==e?void 0:e.response.data;console.log(a),a&&"object"==typeof a?(Object.entries(a).forEach(e=>{let[t,a]=e;Array.isArray(a)&&en.setFieldError(t,a[0])}),S.toast.error(t||s||"Validation failed.")):S.toast.error(s||t||"An error occurred during submission.")}}),en=(0,c.TA)({enableReinitialize:!0,initialValues:M&&Q?{id:Q.id,member_ID:Q.member_ID||"",first_name:Q.first_name||"",last_name:Q.last_name||"",gender:(null===(e=Q.gender)||void 0===e?void 0:e.name)||"",date_of_birth:Q.date_of_birth||null,institute_name:(null===(t=Q.institute_name)||void 0===t?void 0:t.name)||"",batch_number:Q.batch_number||"",membership_status:(null===(a=Q.membership_status)||void 0===a?void 0:a.name)||"",membership_type:(null===(r=Q.membership_type)||void 0===r?void 0:r.name)||"",marital_status:(null===(n=Q.marital_status)||void 0===n?void 0:n.name)||"",anniversary_date:Q.anniversary_date||null,profile_photo:null,blood_group:Q.blood_group||"",nationality:Q.nationality||"Bangladesh"}:{member_ID:"",first_name:"",last_name:"",gender:"",date_of_birth:null,institute_name:"",batch_number:"",membership_status:"",membership_type:"",marital_status:"",anniversary_date:null,profile_photo:null,blood_group:"",nationality:"Bangladesh"},validationSchema:M?el:er,onSubmit:e=>{M?e.id?et(e):S.toast.error("Updation ID not found"):$(e)}});console.log(en.values);let ei=(e,t)=>{en.setFieldValue(e,t);let a="membership_type"===e?en.values.institute_name:en.values.membership_type,s=null==t?void 0:t.trim(),r=null==a?void 0:a.trim();s&&""!==s&&r&&""!==r&&!M&&Y({membership_type:"membership_type"===e?t:en.values.membership_type,institute_name:"institute_name"===e?t:en.values.institute_name})},eo=(0,l.useRef)(null),ed=()=>{F()},ec=()=>{en.resetForm()};return P&&L?(0,s.jsx)(U.Wo,{}):(0,s.jsx)("div",{className:"",children:(0,s.jsxs)("form",{onSubmit:en.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"member_ID",className:"text-sm font-medium text-gray-700",children:"Member ID"}),(0,s.jsx)(h.I,{id:"member_ID",name:"member_ID",disabled:!0,value:en.values.member_ID,onChange:en.handleChange,onBlur:en.handleBlur,className:"w-full",readOnly:!0}),en.touched.member_ID&&en.errors.member_ID&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.member_ID})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Membership Type"}),(0,s.jsxs)(x.Ph,{disabled:M,value:en.values.membership_type,onValueChange:e=>ei("membership_type",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"Choose Membership Type"})}),(0,s.jsx)(x.Bw,{children:null==W?void 0:W.map((e,t)=>(0,s.jsx)(x.Ql,{value:e.name,children:e.name},t))})]}),en.touched.membership_type&&en.errors.membership_type&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.membership_type})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Institute Name"}),(0,s.jsxs)(x.Ph,{disabled:M,value:en.values.institute_name,onValueChange:e=>ei("institute_name",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"Choose Institute"})}),(0,s.jsx)(x.Bw,{children:null==K?void 0:K.map((e,t)=>(0,s.jsxs)(x.Ql,{value:e.name,children:[e.name," - ",e.code]},t))})]}),en.touched.institute_name&&en.errors.institute_name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.institute_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"first_name",className:"text-sm font-medium text-gray-700",children:"First Name"}),(0,s.jsx)(h.I,{id:"first_name",name:"first_name",value:en.values.first_name,onChange:en.handleChange,onBlur:en.handleBlur,placeholder:"Enter first name",className:"w-full"}),en.touched.first_name&&en.errors.first_name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.first_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"last_name",className:"text-sm font-medium text-gray-700",children:"Last Name"}),(0,s.jsx)(h.I,{id:"last_name",name:"last_name",value:en.values.last_name,onChange:en.handleChange,onBlur:en.handleBlur,placeholder:"Enter last name",className:"w-full"}),en.touched.last_name&&en.errors.last_name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.last_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Gender"}),(0,s.jsxs)(x.Ph,{value:en.values.gender,onValueChange:e=>en.setFieldValue("gender",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"Gender",children:en.values.gender?null==X?void 0:null===(o=X.find(e=>e.id==en.values.gender))||void 0===o?void 0:o.name:"Choose Gender"})}),(0,s.jsx)(x.Bw,{children:null==X?void 0:X.map((e,t)=>(0,s.jsx)(x.Ql,{value:e.name,children:e.name},t))})]}),en.touched.gender&&en.errors.gender&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.gender})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Profile Picture"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 pr-5",children:M?null==Q?void 0:null===(d=Q.profile_photo)||void 0===d?void 0:d.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,s.jsx)("input",{ref:eo,type:"file",accept:"image/*",onChange:e=>{var t;e.preventDefault();let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&a&&en.setFieldValue("profile_photo",a)},className:"hidden"}),en.values.profile_photo?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-700",children:en.values.profile_photo?null===(u=en.values.profile_photo)||void 0===u?void 0:u.name:"No file chosen"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>en.setFieldValue("profile_photo",null),children:(0,s.jsx)(E.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(p.z,{type:"button",variant:"ghost",onClick:()=>{var e;return null===(e=eo.current)||void 0===e?void 0:e.click()},className:"w-full",children:[(0,s.jsx)(z.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),en.touched.profile_photo&&en.errors.profile_photo&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.profile_photo})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,s.jsxs)(k.J2,{children:[(0,s.jsx)(k.xo,{asChild:!0,children:(0,s.jsxs)(p.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!en.values.date_of_birth&&"text-muted-foreground"),children:[(0,s.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),en.values.date_of_birth?(0,I.WU)(en.values.date_of_birth,"PPP"):"Select Date"]})}),(0,s.jsx)(k.yk,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(D.f,{mode:"single",captionLayout:"dropdown",selected:en.values.date_of_birth?new Date(en.values.date_of_birth):void 0,onSelect:e=>{if(e){let t=(0,I.WU)(e,"yyyy-MM-dd");en.setFieldValue("date_of_birth",t)}},initialFocus:!0})})]}),en.touched.date_of_birth&&en.errors.date_of_birth&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.date_of_birth})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Membership Status"}),(0,s.jsxs)(x.Ph,{value:en.values.membership_status,onValueChange:e=>en.setFieldValue("membership_status",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"What's Member Status?"})}),(0,s.jsx)(x.Bw,{children:null==G?void 0:G.map((e,t)=>(0,s.jsx)(x.Ql,{value:e.name,children:e.name},t))})]}),en.touched.membership_status&&en.errors.membership_status&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.membership_status})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"batch_number",className:"text-sm font-medium text-gray-700",children:"Batch Number"}),(0,s.jsx)(h.I,{id:"batch_number",name:"batch_number",value:en.values.batch_number,onChange:en.handleChange,onBlur:en.handleBlur,placeholder:"Enter batch year",className:"w-full"}),en.touched.batch_number&&en.errors.batch_number&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.batch_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Marital Status"}),(0,s.jsxs)(x.Ph,{value:en.values.marital_status,onValueChange:e=>en.setFieldValue("marital_status",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"What's Marital Status?"})}),(0,s.jsx)(x.Bw,{children:null==J?void 0:J.map((e,t)=>(0,s.jsx)(x.Ql,{value:e.name,children:e.name},t))})]}),en.touched.marital_status&&en.errors.marital_status&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.marital_status})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Anniversary Date"}),(0,s.jsxs)(k.J2,{children:[(0,s.jsx)(k.xo,{asChild:!0,children:(0,s.jsxs)(p.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!en.values.anniversary_date&&"text-muted-foreground"),children:[(0,s.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),en.values.anniversary_date?(0,I.WU)(en.values.anniversary_date,"PPP"):"Select Date"]})}),(0,s.jsx)(k.yk,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(D.f,{mode:"single",captionLayout:"dropdown",selected:en.values.anniversary_date?new Date(en.values.anniversary_date):void 0,onSelect:e=>{if(e){let t=(0,I.WU)(e,"yyyy-MM-dd");en.setFieldValue("anniversary_date",t)}},initialFocus:!0})})]}),en.touched.anniversary_date&&en.errors.anniversary_date&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.anniversary_date})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Blood Group"}),(0,s.jsxs)(x.Ph,{value:en.values.blood_group,onValueChange:e=>en.setFieldValue("blood_group",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"What is his/her blood type?"})}),(0,s.jsxs)(x.Bw,{children:[(0,s.jsx)(x.Ql,{value:"A+",children:"A+"}),(0,s.jsx)(x.Ql,{value:"A-",children:"A-"}),(0,s.jsx)(x.Ql,{value:"B+",children:"B+"}),(0,s.jsx)(x.Ql,{value:"B-",children:"B-"}),(0,s.jsx)(x.Ql,{value:"AB+",children:"AB+"}),(0,s.jsx)(x.Ql,{value:"AB-",children:"AB-"}),(0,s.jsx)(x.Ql,{value:"O+",children:"O+"}),(0,s.jsx)(x.Ql,{value:"O-",children:"O-"})]})]}),en.touched.blood_group&&en.errors.blood_group&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.blood_group})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Nationality"}),(0,s.jsxs)(x.Ph,{value:en.values.nationality,onValueChange:e=>en.setFieldValue("nationality",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"Select Nationality"})}),(0,s.jsx)(x.Bw,{children:null==v?void 0:v.map((e,t)=>(0,s.jsx)(x.Ql,{value:e,children:e},t))})]}),en.touched.nationality&&en.errors.nationality&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:en.errors.nationality})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>ec(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>ed(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:ee||ea,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[ee||ea?"Saving...":"Save & Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})})}let ei=u.Ry({data:u.IX().of(u.Ry({name:u.Z_().required("Descendant name is required"),descendant_contact_number:u.Z_().required("Contact number is required"),dob:u.hT().required("Date of birth is required"),image:u.nK().nullable().required("Profile picture is required"),relation_type:u.Z_().required("Relation type is required")})).min(1,"At least one descendant is required")}),eo=u.Ry({data:u.IX().of(u.Ry({id:u.Rx().nullable(),name:u.Z_().required("Descendant name is required"),descendant_contact_number:u.Z_().required("Contact number is required"),dob:u.hT().required("Date of birth is required"),image:u.nK().nullable().test("image-required-if-no-id","Profile picture is required",function(e){return!!this.parent.id||!!e}),relation_type:u.Z_().required("Relation type is required")})).min(1,"At least one descendant is required")});function ed(){let e=(0,l.useRef)([]);(0,C.useRouter)();let t=(0,_.NL)(),{currentStep:a,setCurrentStep:r,nextStep:n,markStepCompleted:o,memberID:d,setMemberID:u,isUpdateMode:v}=(0,w.Xm)(),{data:F,isLoading:q}=(0,A.Z)(d,{enabled:v&&!!d}),{descendant:R}=null!=F?F:{},{data:B,isLoading:M}=(0,g.Z)(),{descendant_relation_choice:V}=null!=B?B:{},{mutate:O,isPending:P}=(0,N.D)({mutationFn:async e=>{let t={},a=await Promise.allSettled(e.map(async(e,a)=>{try{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;s instanceof File||s instanceof Blob?t.append(a,s):"boolean"==typeof s||"number"==typeof s?t.append(a,String(s)):null!=s&&t.append(a,s)}),(await j.Z.post("/api/member/v1/members/descendants/",t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(l){var s,r;let{errors:e}=(null==l?void 0:null===(s=l.response)||void 0===s?void 0:s.data)||{};if(console.log(null==l?void 0:null===(r=l.response)||void 0===r?void 0:r.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(t["data.".concat(a,".").concat(s)]=r[0]);return null}}));Object.entries(t).forEach(e=>{let[t,a]=e;Q.setFieldError(t,a)});let s=a.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(a.some(e=>"rejected"===e.status||null===e.value))throw Error("Some descendants failed to submit.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(Q.resetForm(),S.toast.success("All descendants have been successfully added."),o(a),n())},onError:e=>{console.error("Descendant submit error:",e),S.toast.error((null==e?void 0:e.message)||"Some descendants failed to submit.")}}),{mutate:T,isPending:L}=(0,N.D)({mutationFn:async e=>{let t={},a=await Promise.allSettled(e.map(async(e,a)=>{try{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;s instanceof File||s instanceof Blob?t.append(a,s):"boolean"==typeof s||"number"==typeof s?t.append(a,String(s)):null!=s&&t.append(a,s)}),(await j.Z.patch("/api/member/v1/members/descendants/",t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){var s;let{errors:e}=(null==r?void 0:null===(s=r.response)||void 0===s?void 0:s.data)||{};if(console.log(r),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(t["data.".concat(a,".").concat(s)]=r[0]);return null}}));Object.entries(t).forEach(e=>{let[t,a]=e;Q.setFieldError(t,a)});let s=a.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(a.some(e=>"rejected"===e.status||null===e.value))throw Error("Some descendants failed to update.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(t.invalidateQueries({queryKey:["useGetMember",d]}),S.toast.success("All descendants updated."))},onError:e=>{console.error("Descendant update error:",e),S.toast.error((null==e?void 0:e.message)||"Some descendants failed to update.")}}),Q=(0,c.TA)({enableReinitialize:!0,initialValues:v&&R&&(null==R?void 0:R.length)>0?{data:null==R?void 0:R.map(e=>{var t,a;return{id:(null==e?void 0:e.id)||0,member_ID:d,name:(null==e?void 0:e.name)||"",descendant_contact_number:(null==e?void 0:e.descendant_contact_number)||"",dob:(null==e?void 0:e.dob)||null,image:null,relation_type:(null==e?void 0:null===(a=e.relation_type)||void 0===a?void 0:null===(t=a.id)||void 0===t?void 0:t.toString())||""}})}:{data:[{member_ID:d,name:"",descendant_contact_number:"",dob:null,image:null,relation_type:""}]},validationSchema:v?eo:ei,onSubmit:e=>{if(!d){S.toast.error("No Member ID found.");return}v?T(e.data):O(e.data)}}),U=e=>{if(Q.values.data.length>1){let t=Q.values.data.filter((t,a)=>a!==e);Q.setFieldValue("data",t)}else S.toast.error("Cannot remove descendant - at least one descendant is required")},W=(e,t,a)=>{Q.setFieldValue("data.".concat(e,".").concat(t),a)},K=(e,t)=>{var a;let s=null===(a=t.target.files)||void 0===a?void 0:a[0];s?W(e,"image",s):S.toast.error("No file selected")},X=()=>{n()},G=()=>{Q.resetForm()};return(0,s.jsxs)("form",{onSubmit:Q.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[Q.values.data.map((t,a)=>{var r,l,n,o,d,c,u,b,y,g,j,_,N,w,C,S,A,F,q,B,M,O,P,T,L,X,G,J,Y,H,$,ee,et;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[Q.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Descendant ",a+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>U(a),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Descendant Name"}),(0,s.jsx)(h.I,{placeholder:"Enter Descendant Name",value:t.name,onChange:e=>W(a,"name",e.target.value),onBlur:Q.handleBlur,name:"data.".concat(a,".name"),className:"w-full"}),(null===(l=Q.touched.data)||void 0===l?void 0:null===(r=l[a])||void 0===r?void 0:r.name)&&(null===(o=Q.errors.data)||void 0===o?void 0:null===(n=o[a])||void 0===n?void 0:n.name)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(c=Q.errors.data)||void 0===c?void 0:null===(d=c[a])||void 0===d?void 0:d.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Contact Number"}),(0,s.jsx)(h.I,{type:"tel",placeholder:"Enter Descendant Contact",value:t.descendant_contact_number,onChange:e=>W(a,"descendant_contact_number",e.target.value),onBlur:Q.handleBlur,name:"data.".concat(a,".descendant_contact_number"),className:"w-full"}),(null===(b=Q.touched.data)||void 0===b?void 0:null===(u=b[a])||void 0===u?void 0:u.descendant_contact_number)&&(null===(g=Q.errors.data)||void 0===g?void 0:null===(y=g[a])||void 0===y?void 0:y.descendant_contact_number)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(_=Q.errors.data)||void 0===_?void 0:null===(j=_[a])||void 0===j?void 0:j.descendant_contact_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,s.jsxs)(k.J2,{children:[(0,s.jsx)(k.xo,{asChild:!0,children:(0,s.jsxs)(p.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!t.dob&&"text-muted-foreground"),children:[(0,s.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),t.dob?(0,I.WU)(t.dob,"PPP"):"Select Date"]})}),(0,s.jsx)(k.yk,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(D.f,{mode:"single",captionLayout:"dropdown",selected:t.dob?new Date(t.dob):void 0,onSelect:e=>{e&&W(a,"dob",(0,I.WU)(e,"yyyy-MM-dd"))},initialFocus:!0})})]}),(null===(w=Q.touched.data)||void 0===w?void 0:null===(N=w[a])||void 0===N?void 0:N.dob)&&(null===(S=Q.errors.data)||void 0===S?void 0:null===(C=S[a])||void 0===C?void 0:C.dob)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(F=Q.errors.data)||void 0===F?void 0:null===(A=F[a])||void 0===A?void 0:A.dob})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Descendant Picture"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 pr-5",children:v?null===(B=R[a])||void 0===B?void 0:null===(q=B.image)||void 0===q?void 0:q.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,s.jsx)("input",{ref:t=>{e.current[a]=t},type:"file",accept:"image/*",onChange:e=>K(a,e),className:"hidden"}),t.image?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-700",children:t.image.name}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{W(a,"image",null)},children:(0,s.jsx)(E.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(p.z,{type:"button",variant:"ghost",onClick:()=>{var t;null===(t=e.current[a])||void 0===t||t.click()},className:"w-full",children:[(0,s.jsx)(z.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),(null===(O=Q.touched.data)||void 0===O?void 0:null===(M=O[a])||void 0===M?void 0:M.image)&&(null===(T=Q.errors.data)||void 0===T?void 0:null===(P=T[a])||void 0===P?void 0:P.image)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(X=Q.errors.data)||void 0===X?void 0:null===(L=X[a])||void 0===L?void 0:L.image})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Relation Type"}),(0,s.jsxs)(x.Ph,{value:t.relation_type,onValueChange:e=>W(a,"relation_type",e),children:[(0,s.jsx)(x.i4,{className:"w-full",children:(0,s.jsx)(x.ki,{placeholder:"What is the Relation with Member?",children:null==V?void 0:null===(G=V.find(e=>String(e.id)===String(Q.values.data[a].relation_type)))||void 0===G?void 0:G.name})}),(0,s.jsx)(x.Bw,{children:null==V?void 0:V.map(e=>(0,s.jsx)(x.Ql,{value:e.id,children:e.name},e.id))})]}),(null===(Y=Q.touched.data)||void 0===Y?void 0:null===(J=Y[a])||void 0===J?void 0:J.relation_type)&&(null===($=Q.errors.data)||void 0===$?void 0:null===(H=$[a])||void 0===H?void 0:H.relation_type)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(et=Q.errors.data)||void 0===et?void 0:null===(ee=et[a])||void 0===ee?void 0:ee.relation_type})]})]})]},a)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...Q.values.data,{member_ID:d,name:"",descendant_contact_number:"",dob:null,image:null,relation_type:""}];Q.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>G(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>X(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:P||L,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[P||L?"Saving...":"Save & Next"," ",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let ec=u.Ry({data:u.IX().of(u.Ry({title:u.Z_().required("Special day title is required"),date:u.hT().required("Special day date is required")})).min(1,"At least one special day is required")}),eu={data:[{title:"",date:null}]};function em(){(0,C.useRouter)();let e=(0,_.NL)(),{currentStep:t,setCurrentStep:a,nextStep:r,markStepCompleted:l,memberID:n,setMemberID:o,isUpdateMode:d}=(0,w.Xm)(),{data:u,isLoading:v}=(0,A.Z)(n,{enabled:d&&!!n}),{special_days:x}=null!=u?u:{},{mutate:g,isPending:F}=(0,N.D)({mutationFn:async e=>(await j.Z.post("/api/member/v1/members/special_day/",e)).data,onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(z.resetForm(),S.toast.success(e.message||"Special day has been successfully added."),l(t),r())},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);z.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),{mutate:q,isPending:E}=(0,N.D)({mutationFn:async e=>(await j.Z.patch("/api/member/v1/members/special_day/".concat(n),e)).data,onSuccess:t=>{(null==t?void 0:t.status)==="success"&&(e.invalidateQueries({queryKey:["useGetMember",n]}),S.toast.success(t.message||"Special day successfully updated."))},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);z.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),z=(0,c.TA)({enableReinitialize:!0,initialValues:d&&x&&(null==x?void 0:x.length)>0?{data:null==x?void 0:x.map(e=>({id:e.id||0,title:e.title||"",date:e.date?new Date(e.date):null}))}:eu,validationSchema:ec,onSubmit:e=>{if(!n){S.toast.error("No Member ID found.");return}let t={member_ID:n,data:e.data};d?q(t):g(t)}}),R=e=>{if(z.values.data.length>1){let t=z.values.data.filter((t,a)=>a!==e);z.setFieldValue("data",t)}else S.toast.error("At least one special day is required")},B=(e,t,a)=>{z.setFieldValue("data.".concat(e,".").concat(t),a)},M=()=>{r()},V=()=>{z.resetForm()};return(0,s.jsxs)("form",{onSubmit:z.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[z.values.data.map((e,t)=>{var a,r,l,n,o,d,c,u,v,x,b,y;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[z.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Special Day ",t+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(t),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Special Day Title"}),(0,s.jsx)(h.I,{placeholder:"Special Day Name",value:e.title,onChange:e=>B(t,"title",e.target.value),onBlur:z.handleBlur,name:"data.".concat(t,".title"),className:"w-full"}),(null===(r=z.touched.data)||void 0===r?void 0:null===(a=r[t])||void 0===a?void 0:a.title)&&(null===(n=z.errors.data)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l.title)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(d=z.errors.data)||void 0===d?void 0:null===(o=d[t])||void 0===o?void 0:o.title})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Select Special Day"}),(0,s.jsxs)(k.J2,{children:[(0,s.jsx)(k.xo,{asChild:!0,children:(0,s.jsxs)(p.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!e.date&&"text-muted-foreground"),children:[(0,s.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),e.date?(0,I.WU)(e.date,"PPP"):"Choose date"]})}),(0,s.jsx)(k.yk,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(D.f,{mode:"single",captionLayout:"dropdown",selected:z.values.data[t].date?new Date(z.values.data[t].date):void 0,onSelect:e=>{e&&B(t,"date",(0,I.WU)(e,"yyyy-MM-dd"))},initialFocus:!0})})]}),(null===(u=z.touched.data)||void 0===u?void 0:null===(c=u[t])||void 0===c?void 0:c.date)&&(null===(x=z.errors.data)||void 0===x?void 0:null===(v=x[t])||void 0===v?void 0:v.date)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(y=z.errors.data)||void 0===y?void 0:null===(b=y[t])||void 0===b?void 0:b.date})]})]})]},t)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...z.values.data,{title:"",date:null}];z.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>V(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>M(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:F||E,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[F||E?"Saving...":"Save & Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let eh=u.Ry({data:u.IX().of(u.Ry({title:u.Z_().required("Job title is required"),organization_name:u.Z_().required("Organization name is required"),location:u.Z_().required("Location is required")})).min(1,"At least one job detail is required")}),ev={data:[{title:"",organization_name:"",location:""}]};function ep(){(0,C.useRouter)();let e=(0,_.NL)(),{currentStep:t,setCurrentStep:a,nextStep:r,markStepCompleted:l,memberID:n,setMemberID:i,isUpdateMode:o}=(0,w.Xm)(),{data:d,isLoading:u}=(0,A.Z)(n,{enabled:o&&!!n}),{job:v}=null!=d?d:{},{mutate:x,isPending:g}=(0,N.D)({mutationFn:async e=>(await j.Z.post("/api/member/v1/members/job/",e)).data,onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(D.resetForm(),S.toast.success(e.message||"Job Detail has been added."),l(t),r())},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);D.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),{mutate:F,isPending:q}=(0,N.D)({mutationFn:async e=>(await j.Z.patch("/api/member/v1/members/job/".concat(n),e)).data,onSuccess:t=>{(null==t?void 0:t.status)==="success"&&(e.invalidateQueries({queryKey:["useGetMember",n]}),S.toast.success(t.message||"Job Detail has been successfully updated."))},onError:e=>{var t;console.log("error",null==e?void 0:e.response);let{message:a,errors:s,detail:r}=(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)||{};if((null==s?void 0:s.data)&&Array.isArray(s.data)&&s.data.forEach((e,t)=>{if(e&&"object"==typeof e){for(let[a,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e="data.".concat(t,".").concat(a);D.setFieldError(e,s[0])}}}),s&&"object"==typeof s){let e=Object.keys(s).filter(e=>"data"!==e);if(e.length>0){let t=s[e[0]];if(Array.isArray(t)&&t.length>0){S.toast.error(t[0]);return}}}S.toast.error(r||a||"Submission Failed")}}),D=(0,c.TA)({enableReinitialize:!0,initialValues:o&&v&&(null==v?void 0:v.length)>0?{data:null==v?void 0:v.map(e=>({id:(null==e?void 0:e.id)||0,title:(null==e?void 0:e.title)||"",organization_name:(null==e?void 0:e.organization_name)||"",location:(null==e?void 0:e.location)||""}))}:ev,validationSchema:eh,onSubmit:e=>{if(!n){S.toast.error("No Member ID found.");return}let t={member_ID:n,data:e.data};o?F(t):x(t)}}),k=e=>{if(D.values.data.length>1){let t=D.values.data.filter((t,a)=>a!==e);D.setFieldValue("data",t)}else S.toast.error("At least one job detail is required")},Z=(e,t,a)=>{D.setFieldValue("data.".concat(e,".").concat(t),a)},E=()=>{r()},z=()=>{D.resetForm()};return(0,s.jsxs)("form",{onSubmit:D.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[D.values.data.map((e,t)=>{var a,r,l,n,i,o,d,c,u,v,x,b,y,g,j,_,N,w;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[D.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Job Detail ",t+1]}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(t),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Job Title"}),(0,s.jsx)(h.I,{placeholder:"Enter Job Title",value:e.title,onChange:e=>Z(t,"title",e.target.value),onBlur:D.handleBlur,name:"data.".concat(t,".title"),className:"w-full"}),(null===(r=D.touched.data)||void 0===r?void 0:null===(a=r[t])||void 0===a?void 0:a.title)&&(null===(n=D.errors.data)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l.title)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(o=D.errors.data)||void 0===o?void 0:null===(i=o[t])||void 0===i?void 0:i.title})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Organization Name"}),(0,s.jsx)(h.I,{placeholder:"Enter Organization Name",value:e.organization_name,onChange:e=>Z(t,"organization_name",e.target.value),onBlur:D.handleBlur,name:"data.".concat(t,".organization_name"),className:"w-full"}),(null===(c=D.touched.data)||void 0===c?void 0:null===(d=c[t])||void 0===d?void 0:d.organization_name)&&(null===(v=D.errors.data)||void 0===v?void 0:null===(u=v[t])||void 0===u?void 0:u.organization_name)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(b=D.errors.data)||void 0===b?void 0:null===(x=b[t])||void 0===x?void 0:x.organization_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{className:"text-sm font-medium text-gray-700",children:"Location"}),(0,s.jsx)(h.I,{placeholder:"Enter Location",value:e.location,onChange:e=>Z(t,"location",e.target.value),onBlur:D.handleBlur,name:"data.".concat(t,".location"),className:"w-full"}),(null===(g=D.touched.data)||void 0===g?void 0:null===(y=g[t])||void 0===y?void 0:y.location)&&(null===(_=D.errors.data)||void 0===_?void 0:null===(j=_[t])||void 0===j?void 0:j.location)&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:null===(w=D.errors.data)||void 0===w?void 0:null===(N=w[t])||void 0===N?void 0:N.location})]})]})]},t)}),(0,s.jsx)("div",{children:(0,s.jsxs)(p.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...D.values.data,{title:"",organization_name:"",location:""}];D.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[(0,s.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,s.jsx)(p.z,{type:"button",variant:"outline",onClick:()=>z(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),(0,s.jsx)(p.z,{type:"button",variant:"ghost",onClick:()=>E(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(p.z,{type:"submit",disabled:g||q,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[g||q?"Saving...":"Save & Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var ex=a(61312);let ef=ex.zt,eb=ex.fC,ey=ex.xz,eg=l.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...l}=e;return(0,s.jsx)(ex.h_,{children:(0,s.jsx)(ex.VY,{ref:t,sideOffset:r,className:(0,i.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",a),...l})})});eg.displayName=ex.VY.displayName;let ej=[{full:"Membership Details",short:"Membership"},{full:"Member Contact Details",short:"Contact"},{full:"Member Emails Details",short:"Email"},{full:"Member Address Details",short:"Address"},{full:"Member Spouse Details",short:"Spouse"},{full:"Member Descendants Details",short:"Descendants"},{full:"Member Companion Details",short:"Companion"},{full:"Member Emergency Contact Details",short:"Emergency"},{full:"Member Documents Details",short:"Documents"},{full:"Member Certificate Details",short:"Certificate"},{full:"Member Job Details",short:"Job"},{full:"Member Special Days",short:"Special Days"}];function e_(){let{currentStep:e,completedSteps:t,totalSteps:a,memberID:n,setCurrentStep:i,setMemberID:c,setIsUpdateMode:u,resetSteps:m}=(0,w.Xm)(),h=(0,C.usePathname)(),v=null==h?void 0:h.startsWith("/member/update/");(0,l.useEffect)(()=>{if(null==h?void 0:h.startsWith("/member/update/")){let e=h.split("/").pop();e&&e!==n&&(c(e),u(!0))}},[h,n,c,u]),(0,l.useEffect)(()=>()=>{c(""),m(),(null==h?void 0:h.startsWith("/member/update/"))||u(!1)},[h,c,u]);let p=e=>{i(e)},x=(e+1)/a*100;return(0,s.jsx)("div",{className:"text-foreground",children:(0,s.jsxs)("div",{className:"mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:v?(0,s.jsxs)("p",{children:["Update Member"," ",(0,s.jsx)("span",{className:"font-secondary text-lg text-sky-500",children:n&&"#"+n})]}):(0,s.jsxs)("p",{children:["Add New Member"," ",(0,s.jsx)("span",{className:"font-secondary text-lg text-sky-500",children:n&&"#"+n})]})}),(0,s.jsxs)(d.C,{variant:"secondary",className:"text-sm",children:["Step ",e+1," of ",a]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:ej[e].full}),(0,s.jsxs)("span",{children:[Math.round(x),"% Complete"]})]}),(0,s.jsx)(o,{value:x,className:"h-2"})]}),(0,s.jsx)("div",{className:"flex justify-between mt-4 overflow-x-auto",children:(0,s.jsx)(ef,{children:ej.map((a,r)=>(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-1 min-w-0 flex-1 cursor-pointer transition-colors ".concat(r<=e?"text-primary":"text-gray-400"),onClick:()=>p(r),children:[(0,s.jsxs)(eb,{children:[(0,s.jsx)(ey,{asChild:!0,children:(0,s.jsx)("div",{className:"w-7 h-7 md:w-8 md:h-8 rounded-full flex items-center justify-center text-xs font-medium transition-colors ".concat(t.includes(r)?"bg-green-500 text-white":r===e?"bg-primary text-primary-foreground":"bg-gray-200 text-gray-500 hover:bg-gray-300"),children:t.includes(r)?"✓":r+1})}),(0,s.jsx)(eg,{children:(0,s.jsx)("p",{children:a.full})})]}),(0,s.jsx)("span",{className:"hidden sm:block text-xs text-center truncate w-full px-1",children:a.short})]},r))})})]}),(0,s.jsxs)(r.Zb,{className:"shadow-lg",children:[(0,s.jsx)(r.Ol,{className:"pb-4",children:(0,s.jsx)(r.ll,{className:"text-xl text-primary",children:ej[e].full})}),(0,s.jsx)(r.aY,{children:(0,s.jsx)("div",{className:"space-y-6",children:[(0,s.jsx)(en,{},"membership"),(0,s.jsx)(q,{},"contact"),(0,s.jsx)(X,{},"email"),(0,s.jsx)(H,{},"address"),(0,s.jsx)(ea,{},"spouse"),(0,s.jsx)(ed,{},"descendants"),(0,s.jsx)(B,{},"companion"),(0,s.jsx)(O,{},"emergency"),(0,s.jsx)(Q,{},"document"),(0,s.jsx)(T,{},"certificate"),(0,s.jsx)(ep,{},"job"),(0,s.jsx)(em,{},"special-days")][e]})})]})]})})}},46291:function(e,t,a){a.d(t,{f:function(){return c}});var s=a(57437),r=a(2265),l=a(64947),n=a(12381),i=a(90641),o=a(15291),d=a(93448);function c(e){let{className:t,classNames:a,hideNavigation:c,showOutsideDays:u=!0,components:m,...h}=e,v=(0,d.cn)("relative flex flex-col gap-4 sm:flex-row",h.monthsClassName),p=(0,d.cn)("relative flex h-7 items-center justify-center",h.monthCaptionClassName),x=(0,d.cn)("flex items-center justify-center gap-2 w-full",c?"w-full":"",h.dropdownsClassName),f=(0,d.cn)("pt-3 text-sm",h.footerClassName),b=(0,d.cn)("flex",h.weekdaysClassName),y=(0,d.cn)("w-9 text-sm font-normal text-muted-foreground",h.weekdayClassName),g=(0,d.cn)("truncate text-sm font-medium",h.captionLabelClassName),j=(0,d.cn)("mx-auto mt-4",h.monthGridClassName),_=(0,d.cn)("mt-2 flex w-max items-start",h.weekClassName),N=(0,d.cn)("flex size-9 flex-1 items-center justify-center p-0 text-sm",h.dayClassName),w=(0,d.cn)((0,n.d)({variant:"ghost"}),"size-9 rounded-md p-0 font-normal transition-none aria-selected:opacity-100",h.dayButtonClassName),C="bg-accent [&>button]:bg-primary [&>button]:text-primary-foreground [&>button]:hover:bg-primary [&>button]:hover:text-primary-foreground",S=(0,d.cn)(C,"rounded-s-md",h.rangeStartClassName),A=(0,d.cn)(C,"rounded-e-md",h.rangeEndClassName),F=(0,d.cn)("bg-accent !text-foreground [&>button]:bg-transparent [&>button]:!text-foreground [&>button]:hover:bg-transparent [&>button]:hover:!text-foreground",h.rangeMiddleClassName),q=(0,d.cn)("[&>button]:bg-primary [&>button]:text-primary-foreground [&>button]:hover:bg-primary [&>button]:hover:text-primary-foreground",h.selectedClassName),D=(0,d.cn)("[&>button]:bg-accent [&>button]:text-accent-foreground",h.todayClassName),k=(0,d.cn)("text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",h.outsideClassName),Z=(0,d.cn)("text-muted-foreground opacity-50",h.disabledClassName),E=(0,d.cn)("invisible flex-1",h.hiddenClassName),z=r.useCallback(e=>{let{value:t,onChange:a,options:r}=e,l=null==r?void 0:r.find(e=>e.value===t),n=e=>{null==a||a({target:{value:e}})};return(0,s.jsxs)(o.Ph,{value:null==t?void 0:t.toString(),onValueChange:e=>{n(e)},children:[(0,s.jsx)(o.i4,{className:"outline-none focus:ring-0 focus:ring-offset-0",children:(0,s.jsx)(o.ki,{children:null==l?void 0:l.label})}),(0,s.jsx)(o.Bw,{position:"popper",align:"center",children:(0,s.jsx)(i.ScrollArea,{className:"h-80",children:null==r?void 0:r.map((e,t)=>{let{value:a,label:r,disabled:l}=e;return(0,s.jsx)(o.Ql,{value:null==a?void 0:a.toString(),disabled:l,children:r},"".concat(a,"-").concat(t))})})})]})},[]);return(0,s.jsx)(l._,{showOutsideDays:u,hideNavigation:!0,className:(0,d.cn)("p-3",t),classNames:{caption_label:g,day:N,day_button:w,dropdowns:x,footer:f,month:h.monthClassName,month_caption:p,month_grid:j,months:v,week:_,weekday:y,weekdays:b,range_end:A,range_middle:F,range_start:S,selected:q,disabled:Z,hidden:E,outside:k,today:D,nav:"hidden",...a},components:{Dropdown:z,...m},...h})}c.displayName="Calendar"},79820:function(e,t,a){a.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return n},aY:function(){return c},eW:function(){return u},ll:function(){return o}});var s=a(57437),r=a(2265),l=a(93448);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",a),...r})});o.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});d.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...r})});c.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},75060:function(e,t,a){a.d(t,{_:function(){return d}});var s=a(57437),r=a(2265),l=a(6394),n=a(90535),i=a(93448);let o=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.f,{ref:t,className:(0,i.cn)(o(),a),...r})});d.displayName=l.f.displayName},54761:function(e,t,a){a.d(t,{Wo:function(){return i},xg:function(){return n}});var s=a(57437),r=a(93448);function l(e){let{size:t="default",variant:a="default",showText:l=!1,text:n="Loading...",center:i=!1,fullHeight:o=!1,className:d,...c}=e;return(0,s.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center justify-center gap-3",i&&"absolute inset-0 m-auto",o&&"h-full",d),...c,children:[(0,s.jsx)("div",{className:(0,r.cn)("animate-spin rounded-full",{sm:"h-4 w-4 border-2",default:"h-8 w-8 border-3",lg:"h-12 w-12 border-4",xl:"h-16 w-16 border-4"}[t],{default:"border-muted-foreground/20 border-t-muted-foreground/60",primary:"border-muted-foreground/20 border-t-primary",secondary:"border-muted-foreground/20 border-t-secondary",ghost:"border-background/20 border-t-background/80"}[a])}),l&&(0,s.jsx)("p",{className:(0,r.cn)("text-muted-foreground animate-pulse","sm"===t&&"text-xs","default"===t&&"text-sm","lg"===t&&"text-base","xl"===t&&"text-lg"),children:n})]})}function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("flex items-center justify-center h-screen bg-transparent space-x-1.5",t),...a,children:[0,1,2].map(e=>(0,s.jsx)("div",{className:"h-10 w-10 rounded-full animate-bounce bg-primary",style:{animationDelay:"".concat(.1*e,"s")}},e))})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("rounded-lg border bg-card p-4 shadow-sm flex items-center justify-center min-h-[200px]",t),...a,children:(0,s.jsx)(l,{size:"default",variant:"primary",showText:!0})})}},12749:function(e,t,a){a.d(t,{J2:function(){return i},xo:function(){return o},yk:function(){return d}});var s=a(57437),r=a(2265),l=a(27312),n=a(93448);let i=l.fC,o=l.xz;l.ee;let d=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:i=4,...o}=e;return(0,s.jsx)(l.h_,{children:(0,s.jsx)(l.VY,{ref:t,align:r,sideOffset:i,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",a),...o})})});d.displayName=l.VY.displayName},90641:function(e,t,a){a.d(t,{ScrollArea:function(){return i}});var s=a(57437),r=a(2265),l=a(43643),n=a(93448);let i=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(l.fC,{ref:t,className:(0,n.cn)("relative overflow-hidden",a),...i,children:[(0,s.jsx)(l.l_,{className:"h-full w-full rounded-[inherit]",children:r}),(0,s.jsx)(o,{}),(0,s.jsx)(l.Ns,{})]})});i.displayName=l.fC.displayName;let o=r.forwardRef((e,t)=>{let{className:a,orientation:r="vertical",...i}=e;return(0,s.jsx)(l.gb,{ref:t,orientation:r,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,s.jsx)(l.q4,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=l.gb.displayName},94589:function(e,t,a){a.d(t,{r:function(){return i}});var s=a(57437),r=a(2265),l=a(50721),n=a(93448);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.fC,{className:(0,n.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...r,ref:t,children:(0,s.jsx)(l.bU,{className:(0,n.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});i.displayName=l.fC.displayName},23675:function(e,t,a){a.d(t,{g:function(){return n}});var s=a(57437),r=a(2265),l=a(93448);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});n.displayName="Textarea"},81500:function(e,t,a){var s=a(88231),r=a(11713),l=a(94242);t.Z=function(){return(0,r.a)({queryKey:["getAllChoice"],queryFn:async()=>{try{var e;let t=await s.Z.get("/api/core/v1/all_choices/?cache=false");if((null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.status)=="success")return t.data.data;return console.error("Failed to fetch Choices:",t.data.message),[]}catch(e){return console.error("Error fetching Choices stats:",e),l.toast.error("Error fetching Choices"),[]}}})}},23944:function(e,t,a){var s=a(88231),r=a(11713),l=a(94242);t.Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.a)({queryKey:["useGetMember",e],queryFn:async()=>{var t,a,r,n;try{let r=await s.Z.get("/api/member/v1/members/".concat(e,"/"));if((null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.status)=="success")return null===(a=r.data)||void 0===a?void 0:a.data;return console.error("Failed to fetch :",r.data.message),l.toast.error(r.data.message||"Failed to fetch Member"),[]}catch(e){return console.error("Error fetching : ",e),l.toast.error((null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.message)||"Failed to fetch Member"),[]}},enabled:!!e,...t})}},88231:function(e,t,a){var s=a(83464),r=a(40257);let l=s.Z.create({baseURL:r.env.NEXT_PUBLIC_BACKEND_API_URL||"http://localhost:8000",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});t.Z=l},69417:function(e,t,a){a.d(t,{JC:function(){return l},Xm:function(){return i},de:function(){return n}});var s=a(3011),r=a(89134);(0,s.U)()((0,r.tJ)((e,t,a)=>({username:"",setUsername:t=>e({username:t}),clearUsername:()=>{e({username:""}),a.persist.clearStorage()}}),{name:"user-storage"})),(0,s.U)()(e=>({step:1,email:"",otp:"",userInfo:{name:"",password:""},error:"",setEmail:t=>e({email:t}),setOtp:t=>e({otp:t}),setUserInfo:t=>e({}),setError:t=>e({error:t}),nextStep:()=>e(e=>({step:e.step+1})),prevStep:()=>e(e=>({step:e.step-1}))})),(0,s.U)()((0,r.tJ)((e,t)=>({step:1,error:"",setError:t=>e(e=>({error:t})),nextStep:()=>e(e=>({step:e.step+1})),prevStep:()=>e(e=>({step:e.step-1}))}),{name:"member-store",partialize:e=>({step:e.step})})),(0,s.U)()((0,r.tJ)(e=>({token:"",setToken:t=>e({token:t})}),{name:"forget-token-store"}));let l=(0,s.U)((e,t)=>({email:"",otp:"",token:"",setEmail:t=>e({email:t}),setOtp:t=>e({otp:t}),setToken:t=>e({token:t}),reset:()=>e({email:"",otp:"",token:""})})),n=(0,s.U)((e,t)=>({email:"",isOtpPass:!1,setEmail:t=>e({email:t}),setOtpPass:t=>e({isOtpPass:t}),reset:()=>e({email:"",isOtpPass:!1})})),i=(0,s.U)((e,t)=>({currentStep:0,completedSteps:[],totalSteps:12,memberID:"",isUpdateMode:!1,setMemberID:t=>e({memberID:t}),setIsUpdateMode:t=>e({isUpdateMode:t}),setCurrentStep:a=>{let{totalSteps:s}=t();a>=0&&a<s&&e({currentStep:a})},nextStep:()=>{let{currentStep:a,totalSteps:s}=t();a<s-1&&e({currentStep:a+1})},prevStep:()=>{let{currentStep:a}=t();a>0&&e({currentStep:a-1})},markStepCompleted:a=>{let{completedSteps:s}=t();s.includes(a)||e({completedSteps:[...s,a]})},resetSteps:()=>{e({currentStep:0,completedSteps:[]})}}))}}]);