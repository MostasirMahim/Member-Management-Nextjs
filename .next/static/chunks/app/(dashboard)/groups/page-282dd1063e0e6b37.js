(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6749],{28710:function(e,s,a){Promise.resolve().then(a.bind(a,91235))},42208:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},18930:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},91235:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return S}});var t=a(57437),r=a(2265),i=a(99376),n=a(99397),l=a(79205);let o=(0,l.Z)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var d=a(92369);let c=(0,l.Z)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var u=a(42208),m=a(18930),x=a(12381),h=a(79820),p=a(69174),v=a(30767),f=a(74291),j=a(77314),g=a(40279),N=a(75060),y=a(68245),b=a(90641),w=a(31593),C=a(3969),k=a(29827),z=a(21770),A=a(88231),Z=a(23340),F=a(54761);function G(e){let{onCancel:s}=e,{data:a,isLoading:r}=(0,C.Z)(),i=(0,k.NL)(),{mutate:n,isPending:l}=(0,z.D)({mutationFn:async e=>(await A.Z.post("/api/account/v1/authorization/group_permissions/",e)).data,onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(i.invalidateQueries({queryKey:["getGroups"]}),(0,Z.Am)({title:(null==e?void 0:e.details)||"New Group Created",description:(null==e?void 0:e.message)||"New group has been created successfully.",variant:"default"}),o.resetForm(),s())},onError:e=>{console.log("error",null==e?void 0:e.response);let{message:s,errors:a,detail:t}=null==e?void 0:e.response.data;if(a){let e=Object.values(a).flat().join("\n");(0,Z.Am)({title:"Users Added Failed",description:e,variant:"destructive"})}else(0,Z.Am)({title:t||"Users Added Failed",description:s||"An error occurred during Added",variant:"destructive"})}}),o=(0,j.TA)({initialValues:{name:"",permissions:[]},validate:e=>{let s={};return e.name.trim()||(s.name="Group name is required"),0===e.permissions.length&&(s.permissions="At least one permission must be selected"),s},onSubmit:async e=>{n({name:e.name,permission:e.permissions})}}),d=(e,s)=>{let a=o.values.permissions;s?o.setFieldValue("permissions",[...a,e]):o.setFieldValue("permissions",a.filter(s=>s!==e))};return r?(0,t.jsx)(F.xg,{}):(0,t.jsx)("div",{className:"w-full mx-auto",children:(0,t.jsxs)("form",{onSubmit:o.handleSubmit,className:"space-y-2 sm:space-y-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N._,{htmlFor:"name",children:"Group Name"}),(0,t.jsx)(g.I,{id:"name",name:"name",value:o.values.name,onChange:o.handleChange,onBlur:o.handleBlur,placeholder:"Enter group name",className:o.touched.name&&o.errors.name?"border-red-500":""}),o.touched.name&&o.errors.name&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:o.errors.name})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,t.jsx)(N._,{children:"Select Permissions"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{o.setFieldValue("permissions",null==a?void 0:a.map(e=>e.id))},className:"text-xs sm:text-sm bg-transparent",children:"Select All"}),(0,t.jsx)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{o.setFieldValue("permissions",[])},className:"text-xs sm:text-sm bg-transparent",children:"Clear All"})]})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Selected: ",o.values.permissions.length," of ",null==a?void 0:a.length]}),o.touched.permissions&&o.errors.permissions&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:o.errors.permissions}),(0,t.jsx)(b.ScrollArea,{className:"h-[200px] sm:h-[250px] border rounded-md p-3 sm:p-4",children:(0,t.jsx)("div",{className:"space-y-2 sm:space-y-3",children:null==a?void 0:a.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(y.X,{id:e.id,checked:o.values.permissions.includes(e.id),onCheckedChange:s=>d(e.id,s)}),(0,t.jsx)(N._,{htmlFor:e.id,className:"text-xs sm:text-sm font-normal cursor-pointer leading-tight",children:e.name})]},e.id))})})]}),(0,t.jsx)(w.Z,{}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3",children:[(0,t.jsx)(x.z,{type:"button",variant:"outline",onClick:s,className:"w-full sm:w-auto bg-transparent",children:"Cancel"}),(0,t.jsx)(x.z,{type:"submit",disabled:l,className:"w-full sm:w-auto",children:l?"Creating...":"Create Group"})]})]})})}var _=a(11713);function S(){let e=(0,i.useRouter)(),[s,a]=(0,r.useState)(!1),[l,j]=(0,r.useState)(!1),[g,N]=(0,r.useState)(null),y=(0,k.NL)(),{data:b,isLoading:w}=(0,_.a)({queryKey:["getGroups"],queryFn:async()=>{var e,s,a;try{let s=await A.Z.get("/api/account/v2/authorization/group_permissions/");if((null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.status)=="success")return s.data.data;return console.error("Failed to fetch groups:",s.data.message),[]}catch(e){return console.error("Error fetching:",e),(0,Z.Am)({title:"Error",description:(null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to fetch groups",variant:"destructive"}),[]}}}),{mutate:C,isPending:S}=(0,z.D)({mutationFn:async e=>(await A.Z.delete("/api/account/v1/authorization/group_permissions/".concat(e,"/"))).data,onSuccess:e=>{(null==e?void 0:e.status)==="success"&&(y.invalidateQueries({queryKey:["getGroups"]}),(0,Z.Am)({title:(null==e?void 0:e.details)||"Group Removed successfully",description:(null==e?void 0:e.message)||"Group has been successfully Removed.",variant:"default"}),a(!1),N(null))},onError:e=>{console.log("error",null==e?void 0:e.response);let{message:s,errors:a,detail:t}=null==e?void 0:e.response.data;if(a){let e=Object.values(a).flat().join("\n");(0,Z.Am)({title:"Group Removed Failed",description:e,variant:"destructive"})}else(0,Z.Am)({title:t||"Group Removed Failed",description:s||"An error occurred during Removed",variant:"destructive"})}}),V=s=>{e.push("/groups/".concat(s))},R=e=>{N(e),a(!0)};return w||S?(0,t.jsx)(F.xg,{}):(0,t.jsxs)("div",{className:" mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"View All Groups"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage user groups and their permissions"})]}),(0,t.jsxs)(x.z,{onClick:()=>j(!0),className:"w-fit",children:[(0,t.jsx)(n.Z,{className:"w-4 h-4"}),"Create Group"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:null==b?void 0:b.map(e=>(0,t.jsxs)(h.Zb,{className:"hover:shadow-lg transition-shadow",children:[(0,t.jsxs)(h.Ol,{className:"pb-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(h.ll,{className:"text-lg font-semibold",children:e.name}),(0,t.jsx)(o,{className:"w-5 h-5 text-muted-foreground"})]}),(0,t.jsxs)(p.C,{variant:"secondary",className:"w-fit",children:["ID: ",e.id]})]}),(0,t.jsxs)(h.aY,{className:"space-y-3 my-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:["Total member: ",e.user_count]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c,{className:"w-4 h-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:["Total Permissions: ",null==e?void 0:e.permission_count]})]})]}),(0,t.jsxs)(h.eW,{className:"flex gap-2",children:[(0,t.jsxs)(x.z,{variant:"outline",size:"sm",onClick:()=>V(e.id),className:"flex-1",children:[(0,t.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"View"]}),(0,t.jsxs)(x.z,{variant:"destructive",size:"sm",onClick:()=>R({name:e.name,id:e.id}),className:"flex-1",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]},e.id))}),(null==b?void 0:b.length)===0&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(o,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No groups found"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"Create your first group to get started"}),(0,t.jsxs)(x.z,{onClick:()=>j(!0),children:[(0,t.jsx)(n.Z,{className:"w-4 h-4 mr-2"}),"Create Group"]})]}),(0,t.jsx)(v.aR,{open:s,onOpenChange:a,children:(0,t.jsxs)(v._T,{children:[(0,t.jsxs)(v.fY,{children:[(0,t.jsx)(v.f$,{children:"Are you sure?"}),(0,t.jsxs)(v.yT,{children:["This action cannot be undone. This will permanently delete the group"," ",(0,t.jsxs)("span",{className:"font-semibold",children:['"',null==g?void 0:g.name,'"']})," and remove all associated permissions."]})]}),(0,t.jsxs)(v.xo,{children:[(0,t.jsx)(v.le,{children:"Cancel"}),(0,t.jsx)(v.OL,{onClick:()=>{g&&C(g.id)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Group"})]})]})}),(0,t.jsx)(f.Vq,{open:l,onOpenChange:j,children:(0,t.jsxs)(f.cZ,{className:"sm:max-w-[500px]",children:[(0,t.jsx)(f.fK,{children:(0,t.jsx)(f.$N,{children:"Create A Group"})}),(0,t.jsx)(G,{onCancel:()=>j(!1)})]})})]})}},31593:function(e,s,a){"use strict";a.d(s,{Z:function(){return l}});var t=a(57437),r=a(2265),i=a(55156),n=a(93448);let l=r.forwardRef((e,s)=>{let{className:a,orientation:r="horizontal",decorative:l=!0,...o}=e;return(0,t.jsx)(i.f,{ref:s,decorative:l,orientation:r,className:(0,n.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...o})});l.displayName=i.f.displayName},55156:function(e,s,a){"use strict";a.d(s,{f:function(){return d}});var t=a(2265),r=a(66840),i=a(57437),n="horizontal",l=["horizontal","vertical"],o=t.forwardRef((e,s)=>{let{decorative:a,orientation:t=n,...o}=e,d=l.includes(t)?t:n;return(0,i.jsx)(r.WV.div,{"data-orientation":d,...a?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...o,ref:s})});o.displayName="Separator";var d=o}},function(e){e.O(0,[7317,4242,4311,3464,5844,9049,1262,709,1713,277,926,1373,853,2971,2117,1744],function(){return e(e.s=28710)}),_N_E=e.O()}]);