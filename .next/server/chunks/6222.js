"use strict";exports.id=6222,exports.ids=[6222],exports.modules={60318:(e,a,t)=>{t.d(a,{default:()=>ev});var s=t(10326),r=t(29752),n=t(17577),l=t(87273),i=t(51223);let o=n.forwardRef(({className:e,value:a,...t},r)=>s.jsx(l.fC,{ref:r,className:(0,i.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...t,children:s.jsx(l.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));o.displayName=l.fC.displayName;var d=t(38443),c=t(23703),m=t(10123),u=t(44794),p=t(41190),h=t(73326),x=t(91664),f=t(29280),b=t(98091),y=t(83855),g=t(39183),j=t(59395),_=t(47769),v=t(44976),N=t(10119),w=t(59002),C=t(35047),S=t(11439),F=t(54462);let A=m.Ry({contacts:m.IX().of(m.Ry({contact_type:m.Z_().required("Contact type is required"),number:m.Z_().required("Contact number is required"),is_primary:m.O7()})).min(1,"At least one contact is required")});function q(){(0,C.useRouter)();let e=(0,C.usePathname)(),a=e?.startsWith("/member/update/"),{currentStep:t,setCurrentStep:r,nextStep:n,markStepCompleted:l,memberID:i,setMemberID:o}=(0,w.Xm)(),{data:d,isLoading:m}=(0,j.Z)(),{contact_type:q}=d??{},{data:D,isLoading:k}=(0,F.Z)(i,{enabled:a&&!!i}),{contact_info:Z}=D??{},z=(0,v.NL)(),{mutate:E,isPending:I}=(0,N.D)({mutationFn:async e=>(await _.Z.post("/api/member/v1/members/contact_numbers/",e)).data,onSuccess:e=>{e?.status==="success"&&(z.invalidateQueries({queryKey:["useGetMember",i]}),S.toast.success(e.message||"Contact has been successfully added."),B.resetForm(),l(t),n())},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`contacts.${a}.${t}`;B.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),{mutate:R,isPending:M}=(0,N.D)({mutationFn:async e=>(await _.Z.patch(`/api/member/v1/members/contact_numbers/${i}/`,e)).data,onSuccess:e=>{e?.status==="success"&&(console.log(e),z.invalidateQueries({queryKey:["useGetMember",i]}),S.toast.success(e.message||"Contact successfully updated."))},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`contacts.${a}.${t}`;B.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),B=(0,c.TA)({enableReinitialize:!0,initialValues:a&&Z&&Z?.length>0?{contacts:Z?.map(e=>({id:e?.id,contact_type:e.contact_type?.id||"",number:e?.number||"",is_primary:e?.is_primary||!1}))}:{contacts:[{contact_type:"",number:"",is_primary:!1}]},validationSchema:A,onSubmit:e=>{if(!i){S.toast.error("Member ID not found");return}let t={member_ID:i,data:e.contacts};a?R(t):E(t)}}),$=e=>{if(B.values.contacts.length>1){let a=B.values.contacts.filter((a,t)=>t!==e);B.setFieldValue("contacts",a)}else S.toast.error("At least one contact is required")},V=(e,a,t)=>{B.setFieldValue(`contacts.${e}.${a}`,t)},O=()=>{n()},P=()=>{B.resetForm()};return(0,s.jsxs)("form",{onSubmit:B.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[B.values.contacts.map((e,a)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[B.values.contacts.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Contact ",a+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>$(a),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Contact Type"}),(0,s.jsxs)(f.Ph,{value:e.contact_type,onValueChange:e=>V(a,"contact_type",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"What kind of contact is this?",children:q?.find(a=>String(a.id)===String(e.contact_type))?.name??"What kind of contact is this?"})}),s.jsx(f.Bw,{children:q?.map((e,a)=>s.jsx(f.Ql,{value:e.id,children:e.name},a))})]}),B.touched.contacts?.[a]?.contact_type&&B.errors.contacts?.[a]?.contact_type&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.contacts?.[a]?.contact_type})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Contact Number"}),s.jsx(p.I,{type:"tel",placeholder:"Enter contact number",value:e.number,onChange:e=>V(a,"number",e.target.value),onBlur:B.handleBlur,name:`contacts.${a}.number`,className:"w-full"}),B.touched.contacts?.[a]?.number&&B.errors.contacts?.[a]?.number&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.contacts?.[a]?.number})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(h.r,{checked:e.is_primary,onCheckedChange:e=>V(a,"is_primary",e),disabled:B.values.contacts.some((e,t)=>e.is_primary&&t!==a)}),s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Use as Primary"})]})]})]},a)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...B.values.contacts,{contact_type:"",number:"",is_primary:!1}];B.setFieldValue("contacts",e)},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>P(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>O(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:I||M,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[I||M?"Saving...":"Save & Next",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var D=t(33194),k=t(51027),Z=t(37358),z=t(94019),E=t(63685),I=t(45079);let R=m.Ry({member_ID:m.Z_().required("Member ID is required"),companion_name:m.Z_().required("Companion name is required"),companion_dob:m.hT().required("Companion date of birth is required"),companion_contact_number:m.Z_().required("Companion contact number is required"),companion_card_number:m.Z_().required("Companion card number is required"),relation_with_member:m.Z_().required("Relation with member is required"),companion_image:m.nK().nullable()});function M(){let e=(0,n.useRef)(null);(0,C.useRouter)();let a=(0,v.NL)(),{currentStep:t,setCurrentStep:r,nextStep:l,markStepCompleted:o,memberID:d,setMemberID:m,isUpdateMode:h}=(0,w.Xm)(),{data:f,isLoading:b}=(0,F.Z)(d,{enabled:h&&!!d}),{companion:y}=f??{},{mutate:j,isPending:A}=(0,N.D)({mutationFn:async e=>{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{a.append(e,t)}),(await _.Z.post("/api/member/v1/members/companion/",e,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{e?.status==="success"&&(B.resetForm(),S.toast.success(e.message||"Companion has been successfully added."),o(t),l())},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t&&"object"==typeof t){for(let[e,a]of Object.entries(t))if(Array.isArray(a)&&a.length>0&&(B.setFieldError(e,a[0]),"member_ID"===e)){S.toast.error(a[0]);return}S.toast.error("Submission Failed")}else S.toast.error(s||a||"Submission Failed")}}),{mutate:q,isPending:M}=(0,N.D)({mutationFn:async e=>{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{a.append(e,t)}),(await _.Z.patch("/api/member/v1/members/companion/",e,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{e?.status==="success"&&(a.invalidateQueries({queryKey:["useGetMember",d]}),S.toast.success(e.message||"Companion updated."))},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t&&"object"==typeof t){for(let[e,a]of Object.entries(t))if(Array.isArray(a)&&a.length>0&&(B.setFieldError(e,a[0]),"member_ID"===e)){S.toast.error(a[0]);return}S.toast.error("Submission Failed")}else S.toast.error(s||a||"Submission Failed")}}),B=(0,c.TA)({enableReinitialize:!0,initialValues:h&&y&&y?.length>0?{member_ID:d,id:y[0]?.id||0,companion_name:y[0]?.companion_name||"",companion_dob:y[0]?.companion_dob||null,companion_contact_number:y[0]?.companion_contact_number||"",companion_card_number:y[0]?.companion_card_number||"",relation_with_member:y[0]?.relation_with_member||"",companion_image:null}:{member_ID:d,companion_name:"",companion_dob:null,companion_contact_number:"",companion_card_number:"",relation_with_member:"",companion_image:null},validationSchema:R,onSubmit:e=>{if(!d){S.toast.error("No Member ID found.");return}h?q(e):j(e)}}),$=(e,a)=>{B.setFieldValue(e,a)},V=()=>{l()},O=()=>{B.resetForm()};return(0,s.jsxs)("form",{onSubmit:B.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-1 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"companion_name",className:"text-sm font-medium text-gray-700",children:"Companion Name"}),s.jsx(p.I,{id:"companion_name",name:"companion_name",value:B.values.companion_name,onChange:B.handleChange,onBlur:B.handleBlur,placeholder:"Enter Companion Name",className:"w-full"}),B.touched.companion_name&&B.errors.companion_name&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.companion_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,s.jsxs)(k.J2,{children:[s.jsx(k.xo,{asChild:!0,children:(0,s.jsxs)(x.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!B.values.companion_dob&&"text-muted-foreground"),children:[s.jsx(Z.Z,{className:"mr-2 h-4 w-4"}),B.values.companion_dob?(0,I.WU)(B.values.companion_dob,"PPP"):"Select Date"]})}),s.jsx(k.yk,{className:"w-auto p-0",align:"start",children:s.jsx(D.f,{mode:"single",captionLayout:"dropdown",selected:B.values.companion_dob?new Date(B.values.companion_dob):void 0,onSelect:e=>{e&&$("companion_dob",(0,I.WU)(e,"yyyy-MM-dd"))},initialFocus:!0})})]}),B.touched.companion_dob&&B.errors.companion_dob&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.companion_dob})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"companion_contact_number",className:"text-sm font-medium text-gray-700",children:"Contact Number"}),s.jsx(p.I,{id:"companion_contact_number",name:"companion_contact_number",type:"tel",value:B.values.companion_contact_number,onChange:B.handleChange,onBlur:B.handleBlur,placeholder:"Enter Companion Contact",className:"w-full"}),B.touched.companion_contact_number&&B.errors.companion_contact_number&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.companion_contact_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"companion_card_number",className:"text-sm font-medium text-gray-700",children:"Companion Card Number"}),s.jsx(p.I,{id:"companion_card_number",name:"companion_card_number",value:B.values.companion_card_number,onChange:B.handleChange,onBlur:B.handleBlur,placeholder:"Enter Companion Card Number",className:"w-full"}),B.touched.companion_card_number&&B.errors.companion_card_number&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.companion_card_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"relation_with_member",className:"text-sm font-medium text-gray-700",children:"Relation with Member"}),s.jsx(p.I,{id:"relation_with_member",name:"relation_with_member",value:B.values.relation_with_member,onChange:B.handleChange,onBlur:B.handleBlur,placeholder:"Enter Relation with Member",className:"w-full"}),B.touched.relation_with_member&&B.errors.relation_with_member&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.relation_with_member})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Companion Picture"}),s.jsx("p",{className:"text-sm text-gray-500 pr-5",children:h?y[0]?.companion_image?.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[s.jsx("input",{ref:e,type:"file",accept:"image/*",onChange:e=>{let a=e.target.files?.[0];a?B.setFieldValue("companion_image",a):S.toast.error("No file selected")},className:"hidden"}),B.values.companion_image?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsx("span",{className:"text-sm text-gray-700",children:B.values.companion_image.name}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{B.setFieldValue("companion_image",null),e.current&&(e.current.value="")},children:s.jsx(z.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(x.z,{type:"button",variant:"ghost",onClick:()=>{e.current?.click()},className:"w-full",children:[s.jsx(E.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>O(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>V(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:A||M,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[A||M?"Saving...":"Save & Next"," ",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let B=m.Ry({data:m.IX().of(m.Ry({contact_name:m.Z_().required("Contact name is required"),contact_number:m.Z_().required("Contact number is required"),relation_with_member:m.Z_().required("Relation with member is required")})).min(1,"At least one emergency contact is required")}),$={data:[{contact_name:"",contact_number:"",relation_with_member:""}]};function V(){(0,C.useRouter)();let e=(0,v.NL)(),{currentStep:a,setCurrentStep:t,nextStep:r,markStepCompleted:n,memberID:l,setMemberID:i,isUpdateMode:o}=(0,w.Xm)(),{data:d,isLoading:m}=(0,F.Z)(l,{enabled:o&&!!l}),{emergency_contact:h}=d??{},{mutate:f,isPending:j}=(0,N.D)({mutationFn:async e=>(await _.Z.post("/api/member/v1/members/emergency_contact/",e)).data,onSuccess:e=>{e?.status==="success"&&(D.resetForm(),S.toast.success(e.message||"Emergency Contact has been successfully added."),n(a),r())},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;D.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),{mutate:A,isPending:q}=(0,N.D)({mutationFn:async e=>(await _.Z.patch(`/api/member/v1/members/emergency_contact/${l}/`,e)).data,onSuccess:a=>{a?.status==="success"&&(e.invalidateQueries({queryKey:["useGetMember",l]}),S.toast.success(a.message||"Emergency Contact has been successfully updated."))},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;D.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),D=(0,c.TA)({enableReinitialize:!0,initialValues:o&&h&&h?.length>0?{data:h?.map(e=>({id:e?.id||0,contact_name:e?.contact_name||"",contact_number:e?.contact_number||"",relation_with_member:e?.relation_with_member||""}))}:$,validationSchema:B,onSubmit:e=>{if(!l){S.toast.error("No Member ID found. Please start from member creation.");return}let a={member_ID:l,data:e.data};o?A(a):f(a)}}),k=e=>{if(D.values.data.length>1){let a=D.values.data.filter((a,t)=>t!==e);D.setFieldValue("data",a)}else S.toast.error("At least one emergency contact is required")},Z=(e,a,t)=>{D.setFieldValue(`data.${e}.${a}`,t)},z=()=>{r()},E=()=>{D.resetForm()};return(0,s.jsxs)("form",{onSubmit:D.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[D.values.data.map((e,a)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[D.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Emergency Contact ",a+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(a),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Contact Name"}),s.jsx(p.I,{placeholder:"Enter Emergency Contact Name",value:e.contact_name,onChange:e=>Z(a,"contact_name",e.target.value),onBlur:D.handleBlur,name:`data.${a}.contact_name`,className:"w-full"}),D.touched.data?.[a]?.contact_name&&D.errors.data?.[a]?.contact_name&&s.jsx("p",{className:"text-sm text-red-600",children:D.errors.data?.[a]?.contact_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Contact Number"}),s.jsx(p.I,{type:"tel",placeholder:"Enter Emergency Contact",value:e.contact_number,onChange:e=>Z(a,"contact_number",e.target.value),onBlur:D.handleBlur,name:`data.${a}.contact_number`,className:"w-full"}),D.touched.data?.[a]?.contact_number&&D.errors.data?.[a]?.contact_number&&s.jsx("p",{className:"text-sm text-red-600",children:D.errors.data?.[a]?.contact_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Relation With Member"}),s.jsx(p.I,{placeholder:"Enter Relation With Member",value:e.relation_with_member,onChange:e=>Z(a,"relation_with_member",e.target.value),onBlur:D.handleBlur,name:`data.${a}.relation_with_member`,className:"w-full"}),D.touched.data?.[a]?.relation_with_member&&D.errors.data?.[a]?.relation_with_member&&s.jsx("p",{className:"text-sm text-red-600",children:D.errors.data?.[a]?.relation_with_member})]})]})]},a)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...D.values.data,{contact_name:"",contact_number:"",relation_with_member:""}];D.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>E(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>z(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:j||q,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[j||q?"Saving...":"Save & Next",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let O=m.Ry({data:m.IX().of(m.Ry({member_ID:m.Z_().required("Member ID is required"),title:m.Z_().required("Certificate title is required"),certificate_document:m.nK().required("Certificate document is required"),certificate_number:m.Z_().required("Certificate number is required")})).min(1,"At least one certificate is required")});function P(){let e=(0,n.useRef)([]);(0,C.useRouter)();let a=(0,v.NL)(),{currentStep:t,setCurrentStep:r,nextStep:l,markStepCompleted:i,memberID:o,setMemberID:d,isUpdateMode:m}=(0,w.Xm)(),{data:h,isLoading:f}=(0,F.Z)(o,{enabled:m&&!!o}),{certificate:j}=h??{},{mutate:A,isPending:q}=(0,N.D)({mutationFn:async e=>{let a={},t=await Promise.allSettled(e.map(async(e,t)=>{try{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{t instanceof File||t instanceof Blob?a.append(e,t):"boolean"==typeof t||"number"==typeof t?a.append(e,String(t)):null!=t&&a.append(e,t)}),(await _.Z.post("/api/member/v1/members/certificate/",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){let{errors:e}=s?.response?.data||{};if(console.log(s?.response?.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(a[`data.${t}.${s}`]=r[0]);return null}}));Object.entries(a).forEach(([e,a])=>{Z.setFieldError(e,a)});let s=t.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(t.some(e=>"rejected"===e.status||null===e.value))throw Error("Some certificates failed to submit.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(Z.resetForm(),S.toast.success("All Certificates have been successfully added."),i(t),l())},onError:e=>{console.error("Certificate submit error:",e),S.toast.error(e?.message||"Some certificates failed to submit.")}}),{mutate:D,isPending:k}=(0,N.D)({mutationFn:async e=>{let a={},t=await Promise.allSettled(e.map(async(e,t)=>{try{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{t instanceof File||t instanceof Blob?a.append(e,t):"boolean"==typeof t||"number"==typeof t?a.append(e,String(t)):null!=t&&a.append(e,t)}),(await _.Z.patch("/api/member/v1/members/certificate/",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){let{errors:e}=s?.response?.data||{};if(console.log(s?.response?.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(a[`data.${t}.${s}`]=r[0]);return null}}));Object.entries(a).forEach(([e,a])=>{Z.setFieldError(e,a)});let s=t.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(t.some(e=>"rejected"===e.status||null===e.value))throw Error("Some certificates failed to update.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(a.invalidateQueries({queryKey:["useGetMember",o]}),S.toast.success("All Certificate updated."))},onError:e=>{console.error("Certificate update error:",e),S.toast.error(e?.message||"Some certificates failed to update.")}}),Z=(0,c.TA)({enableReinitialize:!0,initialValues:m&&j&&j?.length>0?{data:j?.map(e=>({id:e?.id||0,member_ID:o,title:e?.title||"",certificate_document:null,certificate_number:e?.certificate_number||""}))}:{data:[{member_ID:o,title:"",certificate_document:null,certificate_number:""}]},validationSchema:O,onSubmit:e=>{if(!o){S.toast.error("Member ID not found");return}m?D(e.data):A(e.data)}}),I=e=>{if(Z.values.data.length>1){let a=Z.values.data.filter((a,t)=>t!==e);Z.setFieldValue("data",a)}else S.toast.error("At least one certificate is required")},R=(e,a,t)=>{Z.setFieldValue(`data.${e}.${a}`,t)},M=(e,a)=>{let t=a.target.files?.[0];t?R(e,"certificate_document",t):S.toast.error("No file selected")},B=a=>{R(a,"certificate_document",null),e.current[a]&&(e.current[a].value="")},$=()=>{l()},V=()=>{Z.resetForm()};return(0,s.jsxs)("form",{onSubmit:Z.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[Z.values.data.map((a,t)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[Z.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Certificate ",t+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>I(t),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Certificate Title"}),s.jsx(p.I,{placeholder:"Enter Certificate Title",value:a.title,onChange:e=>R(t,"title",e.target.value),onBlur:Z.handleBlur,name:`data.${t}.title`,className:"w-full"}),Z.touched.data?.[t]?.title&&Z.errors.data?.[t]?.title&&s.jsx("p",{className:"text-sm text-red-600",children:Z.errors.data?.[t]?.title})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Upload Certificate"}),s.jsx("p",{className:"text-sm text-gray-500 pr-5",children:m?j[t]?.certificate_document?.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[s.jsx("input",{ref:a=>{e.current[t]=a},type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:e=>M(t,e),className:"hidden"}),a.certificate_document?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsx("span",{className:"text-sm text-gray-700",children:a.certificate_document.name}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>B(t),children:s.jsx(z.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(x.z,{type:"button",variant:"ghost",onClick:()=>{e.current[t]?.click(),console.log(`Clicked to upload certificate ${t} file`)},className:"w-full",children:[s.jsx(E.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),Z.touched.data?.[t]?.certificate_document&&Z.errors.data?.[t]?.certificate_document&&s.jsx("p",{className:"text-sm text-red-600",children:Z.errors.data?.[t]?.certificate_document})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Certificate Number"}),s.jsx(p.I,{placeholder:"Enter Certificate Number",value:a.certificate_number,onChange:e=>R(t,"certificate_number",e.target.value),onBlur:Z.handleBlur,name:`data.${t}.certificate_number`,className:"w-full"}),Z.touched.data?.[t]?.certificate_number&&Z.errors.data?.[t]?.certificate_number&&s.jsx("p",{className:"text-sm text-red-600",children:Z.errors.data?.[t]?.certificate_number})]})]})]},t)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...Z.values.data,{member_ID:o,title:"",certificate_document:null,certificate_number:""}];Z.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>V(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>$(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:q||k,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[q||k?"Saving...":"Save & Next"," ",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let T=m.Ry({data:m.IX().of(m.Ry({member_ID:m.Z_().required("Member ID is required"),document_document:m.nK().required("Document file is required"),document_type:m.Z_().required("Document type is required")})).min(1,"At least one document is required")});function Q(){let e=(0,n.useRef)([]);(0,C.useRouter)();let a=(0,v.NL)(),{currentStep:t,setCurrentStep:r,nextStep:l,markStepCompleted:i,memberID:o,setMemberID:d,isUpdateMode:m}=(0,w.Xm)(),{data:p,isLoading:h}=(0,F.Z)(o,{enabled:m&&!!o}),{document:A}=p??{},{data:q,isLoading:D}=(0,j.Z)(),{document_type:k}=q??{},{mutate:Z,isPending:I}=(0,N.D)({mutationFn:async e=>{let a={},t=await Promise.allSettled(e.map(async(e,t)=>{try{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{t instanceof File||t instanceof Blob?a.append(e,t):"boolean"==typeof t||"number"==typeof t?a.append(e,String(t)):null!=t&&a.append(e,t)}),(await _.Z.post("/api/member/v1/members/documents/",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){let{errors:e}=s?.response?.data||{};if(console.log(s?.response?.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(a[`data.${t}.${s}`]=r[0]);return null}}));Object.entries(a).forEach(([e,a])=>{B.setFieldError(e,a)});let s=t.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(t.some(e=>"rejected"===e.status||null===e.value))throw Error("Some documents failed to upload.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(B.resetForm(),S.toast.success("All document successfully added."),i(t),l())},onError:e=>{console.error("Documents submit error:",e),S.toast.error(e?.message||"Some documents failed to submit.")}}),{mutate:R,isPending:M}=(0,N.D)({mutationFn:async e=>{let a={},t=await Promise.allSettled(e.map(async(e,t)=>{try{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{t instanceof File||t instanceof Blob?a.append(e,t):"boolean"==typeof t||"number"==typeof t?a.append(e,String(t)):null!=t&&a.append(e,t)}),(await _.Z.patch("/api/member/v1/members/documents/",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){let{errors:e}=s?.response?.data||{};if(console.log(s?.response?.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(a[`data.${t}.${s}`]=r[0]);return null}}));Object.entries(a).forEach(([e,a])=>{B.setFieldError(e,a)});let s=t.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(t.some(e=>"rejected"===e.status||null===e.value))throw Error("Some documents failed to update.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(a.invalidateQueries({queryKey:["useGetMember",o]}),S.toast.success("All document updated."))},onError:e=>{console.error("Documents update error:",e),S.toast.error(e?.message||"Some documents failed to update.")}}),B=(0,c.TA)({enableReinitialize:!0,initialValues:m&&A&&A?.length>0?{data:A?.map(e=>({id:e?.id||0,member_ID:o,document_document:null,document_type:e?.document_type?.id?.toString()||""}))}:{data:[{member_ID:o,document_document:null,document_type:""}]},validationSchema:T,onSubmit:e=>{if(!o){S.toast.error("Member ID not found");return}m?R(e.data):Z(e.data)}}),$=e=>{if(B.values.data.length>1){let a=B.values.data.filter((a,t)=>t!==e);B.setFieldValue("data",a)}else S.toast.error("At least one document is required")},V=(e,a,t)=>{B.setFieldValue(`data.${e}.${a}`,t)},O=(e,a)=>{let t=a.target.files?.[0];t&&V(e,"document_document",t)},P=()=>{l()},Q=()=>{B.resetForm()};return(0,s.jsxs)("form",{onSubmit:B.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[B.values.data.map((a,t)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[B.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Document ",t+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>$(t),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Upload Document"}),s.jsx("p",{className:"text-sm text-gray-500 pr-5",children:m?A[t]?.document_document?.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[s.jsx("input",{ref:a=>{e.current[t]=a},type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:e=>O(t,e),className:"hidden"}),a.document_document?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsx("span",{className:"text-sm text-gray-700",children:a.document_document.name}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{V(t,"document_document",null),console.log(`Removed document ${t} file`)},children:s.jsx(z.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(x.z,{type:"button",variant:"ghost",onClick:()=>{e.current[t]?.click(),console.log(`Clicked to upload document ${t} file`)},className:"w-full",children:[s.jsx(E.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),B.touched.data?.[t]?.document_document&&B.errors.data?.[t]?.document_document&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.data?.[t]?.document_document})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Select Document Type"}),(0,s.jsxs)(f.Ph,{value:a.document_type,onValueChange:e=>V(t,"document_type",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"What kind of document is this?",children:k?.find(e=>String(e.id)===String(a.document_type))?.name??"What kind of document is this?"})}),s.jsx(f.Bw,{children:k?.map(e=>s.jsx(f.Ql,{value:e.id,children:e.name},e.id))})]}),B.touched.data?.[t]?.document_type&&B.errors.data?.[t]?.document_type&&s.jsx("p",{className:"text-sm text-red-600",children:B.errors.data?.[t]?.document_type})]})]})]},t)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...B.values.data,{member_ID:o,document_document:null,document_type:""}];B.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>Q(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>P(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:I||M,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[I||M?"Saving...":"Save & Next",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var L=t(24055);let U=m.Ry({data:m.IX().of(m.Ry({email_type:m.Rx().required("Email type is required"),email:m.Z_().email("Invalid email format").required("Email address is required"),is_primary:m.O7()})).min(1,"At least one email is required")}),W={data:[{email_type:null,email:"",is_primary:!1}]};function G(){(0,C.useRouter)();let e=(0,v.NL)(),{currentStep:a,setCurrentStep:t,nextStep:r,markStepCompleted:n,memberID:l,setMemberID:i,isUpdateMode:o}=(0,w.Xm)(),{data:d,isLoading:m}=(0,j.Z)(),{email_type:A}=d??{},{data:q,isLoading:D}=(0,F.Z)(l,{enabled:o&&!!l}),{email_address:k}=q??{},{mutate:Z,isPending:z}=(0,N.D)({mutationFn:async e=>(await _.Z.post("/api/member/v1/members/email_address/",e)).data,onSuccess:t=>{t?.status==="success"&&(e.invalidateQueries({queryKey:["useGetMember",l]}),S.toast.success(t.message||"Email has been successfully added."),n(a),r(),R.resetForm())},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;R.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),{mutate:E,isPending:I}=(0,N.D)({mutationFn:async e=>(await _.Z.patch(`/api/member/v1/members/email_address/${l}/`,e)).data,onSuccess:a=>{a?.status==="success"&&(e.invalidateQueries({queryKey:["useGetMember",l]}),S.toast.success(a.message||"Email successfully updated."))},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;R.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),R=(0,c.TA)({enableReinitialize:!0,initialValues:o&&k&&k?.length>0?{data:k?.map(e=>({id:e?.id||0,email_type:e?.email_type.id||null,email:e?.email||"",is_primary:e?.is_primary||!1}))}:W,validationSchema:U,onSubmit:e=>{if(!l){S.toast.error("No Member ID found. Please start from member creation.");return}let a={member_ID:l,data:e.data};o?E(a):Z(a)}}),M=e=>{R.values.data.length>1?R.setFieldValue("data",R.values.data.filter((a,t)=>t!==e)):S.toast.error("At least one email is required")},B=(e,a,t)=>{"is_primary"===a&&!0===t?R.setFieldValue("data",R.values.data.map((a,t)=>({...a,is_primary:t===e}))):R.setFieldValue(`data.${e}.${a}`,t)};return m||D?s.jsx(L.Wo,{}):(0,s.jsxs)("form",{onSubmit:R.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[R.values.data.map((e,a)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[R.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Email ",a+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>M(a),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Email Type"}),(0,s.jsxs)(f.Ph,{value:e.email_type,onValueChange:e=>B(a,"email_type",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"What kind of Email is this?",children:A?.find(a=>String(a.id)===String(e.email_type))?.name??"Select email type"})}),s.jsx(f.Bw,{children:A?.map((e,a)=>s.jsx(f.Ql,{value:e.id,children:e.name},a))})]}),R.touched.data?.[a]?.email_type&&R.errors.data?.[a]?.email_type&&s.jsx("p",{className:"text-sm text-red-600",children:R.errors.data?.[a]?.email_type})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Email Address"}),s.jsx(p.I,{type:"email",placeholder:"Enter email address",value:e.email,onChange:e=>B(a,"email",e.target.value),onBlur:R.handleBlur,name:`data.${a}.email`,className:"w-full"}),R.touched.data?.[a]?.email&&R.errors.data?.[a]?.email&&s.jsx("p",{className:"text-sm text-red-600",children:R.errors.data?.[a]?.email})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(h.r,{checked:e.is_primary,onCheckedChange:e=>B(a,"is_primary",e)}),s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Use as Primary"})]})]})]},a)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{R.setFieldValue("data",[...R.values.data,{email_type:null,email:"",is_primary:!1}])},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4"}),"Add Emails"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>{R.resetForm()},className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>{r()},className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:z||I,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[z||I?"Saving...":"Save & Next"," ",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var K=t(82015);let X=m.Ry({data:m.IX().of(m.Ry({address_type:m.Rx().required("Address type is required"),address:m.Z_().required("Address is required"),is_primary:m.O7()})).min(1,"At least one address is required")}),J={data:[{address_type:"",address:"",is_primary:!1}]};function Y(){(0,C.useRouter)();let{currentStep:e,setCurrentStep:a,nextStep:t,markStepCompleted:r,memberID:n,setMemberID:l,isUpdateMode:i}=(0,w.Xm)(),{data:o}=(0,j.Z)(),{address_type:d}=o??{},m=(0,v.NL)(),{data:p,isLoading:A}=(0,F.Z)(n,{enabled:i&&!!n}),{address:q}=p??{},{mutate:D,isPending:k}=(0,N.D)({mutationFn:async e=>(await _.Z.post("/api/member/v1/members/address/",e)).data,onSuccess:a=>{a?.status==="success"&&(I.resetForm(),S.toast.success(a.message||"Address has been successfully added."),r(e),t())},onError:E}),{mutate:Z,isPending:z}=(0,N.D)({mutationFn:async e=>(await _.Z.patch(`/api/member/v1/members/address/${n}/`,e)).data,onSuccess:e=>{e?.status==="success"&&(S.toast.success(e.message||"Address has been successfully updated."),m.invalidateQueries({queryKey:["useGetMember",n]}))},onError:E});function E(e){console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;I.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}let I=(0,c.TA)({enableReinitialize:!0,initialValues:i&&q&&q?.length>0?{data:q?.map(e=>({id:e.id||0,address_type:e.address_type.id||0,address:e.address||"",is_primary:e.is_primary||!1}))}:J,validationSchema:X,onSubmit:e=>{if(!n){S.toast.error("No Member ID found.");return}let a={member_ID:n,data:e.data};i?Z(a):D(a)}}),R=e=>{I.values.data.length>1?I.setFieldValue("data",I.values.data.filter((a,t)=>t!==e)):S.toast.error("At least one address is required")},M=(e,a,t)=>{"is_primary"===a&&!0===t?I.setFieldValue("data",I.values.data.map((a,t)=>({...a,is_primary:t===e}))):I.setFieldValue(`data.${e}.${a}`,t)};return(0,s.jsxs)("form",{onSubmit:I.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[I.values.data.map((e,a)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[I.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Address ",a+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(a),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{children:"Address Type"}),(0,s.jsxs)(f.Ph,{value:String(e.address_type),onValueChange:e=>M(a,"address_type",e),children:[s.jsx(f.i4,{children:s.jsx(f.ki,{placeholder:"What kind of Address is this?",children:d?.find(a=>String(a.id)===String(e.address_type))?.name??"Select address type"})}),s.jsx(f.Bw,{children:d?.map(e=>s.jsx(f.Ql,{value:String(e.id),children:e.name},e.id))})]}),I.touched.data?.[a]?.address_type&&I.errors.data?.[a]?.address_type&&s.jsx("p",{className:"text-sm text-red-600",children:I.errors.data?.[a]?.address_type})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{children:"Address"}),s.jsx(K.g,{placeholder:"Enter full address",value:e.address,onChange:e=>M(a,"address",e.target.value),onBlur:I.handleBlur,name:`data.${a}.address`}),I.touched.data?.[a]?.address&&I.errors.data?.[a]?.address&&s.jsx("p",{className:"text-sm text-red-600",children:I.errors.data?.[a]?.address})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(h.r,{checked:e.is_primary,onCheckedChange:e=>M(a,"is_primary",e)}),s.jsx(u._,{children:"Use as Primary"})]})]})]},a)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{I.setFieldValue("data",[...I.values.data,{address_type:"",address:"",is_primary:!1}])},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4"}),"Add Addresses"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>{I.resetForm()},className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>t(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:k||z,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[k||z?"Saving...":"Save & Next",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let H=m.Ry({spouse_name:m.Z_().required("Spouse name is required"),contact_number:m.Z_().required("Contact number is required"),spouse_dob:m.hT().required("Spouse date of birth is required"),image:m.nK().nullable().required("Profile picture is required"),current_status:m.Z_().required("Current status is required")}),ee=m.Ry({spouse_name:m.Z_().required("Spouse name is required"),contact_number:m.Z_().required("Contact number is required"),spouse_dob:m.hT().required("Spouse date of birth is required"),image:m.nK().nullable(),current_status:m.Z_().required("Current status is required")}),ea={member_ID:"",spouse_name:"",contact_number:"",spouse_dob:null,image:null,current_status:""};function et(){let e=(0,n.useRef)(null);(0,C.useRouter)();let a=(0,v.NL)(),{currentStep:t,setCurrentStep:r,nextStep:l,markStepCompleted:o,memberID:d,setMemberID:m,isUpdateMode:h}=(0,w.Xm)(),{data:b,isLoading:y}=(0,F.Z)(d,{enabled:h&&!!d}),{spouse:A}=b??{},{data:q,isLoading:R}=(0,j.Z)(),{spouse_status_choice:M}=q??{},{mutate:B,isPending:$}=(0,N.D)({mutationFn:async e=>{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{null!=t&&a.append(e,t)}),(await _.Z.post("/api/member/v1/members/spouse/",e,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{e?.status==="success"&&(S.toast.success(e.message||"Spouse has been successfully added."),o(t),l())},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t&&"object"==typeof t){for(let[e,a]of Object.entries(t))Array.isArray(a)&&a.length>0&&P.setFieldError(e,a[0]);S.toast.error("Submission Failed")}else S.toast.error(s||a||"Submission Failed")}}),{mutate:V,isPending:O}=(0,N.D)({mutationFn:async e=>{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{a.append(e,t)}),(await _.Z.patch("/api/member/v1/members/spouse/",e,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{e?.status==="success"&&(a.invalidateQueries({queryKey:["useGetMember",d]}),S.toast.success(e.message||"Spouse has been successfully updated."))},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t&&"object"==typeof t){for(let[e,a]of Object.entries(t))Array.isArray(a)&&a.length>0&&P.setFieldError(e,a[0]);S.toast.error("Submission Failed")}else S.toast.error(s||a||"Submission Failed")}}),P=(0,c.TA)({enableReinitialize:!0,initialValues:h&&A&&A?.length>0?{member_ID:d||"",id:A[0]?.id||0,spouse_name:A[0]?.spouse_name||"",contact_number:A[0]?.spouse_contact_number||"",spouse_dob:A[0]?.spouse_dob||null,image:null,current_status:A[0]?.current_status?.toString()||""}:ea,validationSchema:h?ee:H,onSubmit:e=>{if(!d){S.toast.error("No Member ID found.");return}e.member_ID=d,e.member_ID&&(h?V(e):B(e))}}),T=(e,a)=>{P.setFieldValue(e,a)},Q=()=>{l()},U=()=>{P.resetForm()};return R||y?s.jsx(L.Wo,{}):(0,s.jsxs)("form",{onSubmit:P.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[s.jsx(u._,{htmlFor:"spouse_name",className:"text-sm font-medium text-gray-700",children:"Spouse Name"}),s.jsx(p.I,{id:"spouse_name",name:"spouse_name",value:P.values.spouse_name,onChange:P.handleChange,onBlur:P.handleBlur,placeholder:"Enter Spouse Name",className:"w-full"}),P.errors.spouse_name&&P.touched.spouse_name&&s.jsx("p",{className:"text-sm text-red-600",children:P.errors.spouse_name})]}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[s.jsx(u._,{htmlFor:"contact_number",className:"text-sm font-medium text-gray-700",children:"Contact Number"}),s.jsx(p.I,{id:"contact_number",name:"contact_number",type:"tel",value:P.values.contact_number,onChange:P.handleChange,onBlur:P.handleBlur,placeholder:"Enter Spouse Contact",className:"w-full"}),P.errors.contact_number&&P.touched.contact_number&&s.jsx("p",{className:"text-sm text-red-600",children:P.errors.contact_number})]})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-1 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,s.jsxs)(k.J2,{children:[s.jsx(k.xo,{asChild:!0,children:(0,s.jsxs)(x.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!P.values.spouse_dob&&"text-muted-foreground"),children:[s.jsx(Z.Z,{className:"mr-2 h-4 w-4"}),P.values.spouse_dob?(0,I.WU)(P.values.spouse_dob,"PPP"):"Select Date"]})}),s.jsx(k.yk,{className:"w-auto p-0",align:"start",children:s.jsx(D.f,{mode:"single",captionLayout:"dropdown",selected:P.values.spouse_dob?new Date(P.values.spouse_dob):void 0,onSelect:e=>{if(e){let a=(0,I.WU)(e,"yyyy-MM-dd");P.setFieldValue("spouse_dob",a)}},initialFocus:!0})})]}),P.errors.spouse_dob&&P.touched.spouse_dob&&"string"==typeof P.errors.spouse_dob&&s.jsx("p",{className:"text-sm text-red-600",children:P.errors.spouse_dob})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Status"}),(0,s.jsxs)(f.Ph,{value:P.values.current_status,onValueChange:e=>T("current_status",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"What is the spouse status?",children:M?.find(e=>String(e.id)===String(P.values.current_status))?.name})}),s.jsx(f.Bw,{children:M?.map(e=>s.jsx(f.Ql,{value:e.id,children:e.name},e.id))})]}),P.errors.current_status&&P.touched.current_status&&s.jsx("p",{className:"text-sm text-red-600",children:P.errors.current_status})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Spouse Picture"}),s.jsx("p",{className:"text-sm text-gray-500 pr-5",children:h?A[0]?.image?.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[s.jsx("input",{ref:e,type:"file",accept:"image/*",onChange:e=>{let a=e.target.files?.[0];a?P.setFieldValue("image",a):S.toast.error("No file selected")},className:"hidden"}),P.values.image?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsx("span",{className:"text-sm text-gray-700",children:P.values.image.name}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{T("image",null)},children:s.jsx(z.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(x.z,{type:"button",variant:"ghost",onClick:()=>{e.current?.click()},className:"w-full",children:[s.jsx(E.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>U(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>Q(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:$||O,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[$||O?"Saving...":"Save & Next",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var es=t(61603);let er=m.Ry({member_ID:m.Z_().required("Member ID is required"),first_name:m.Z_().required("First name is required"),last_name:m.Z_(),gender:m.Z_().required("Gender is required"),date_of_birth:m.hT().required("Date of birth is required"),institute_name:m.Z_().required("Institute name is required"),batch_number:m.Z_().required("Batch number is required"),membership_status:m.Z_().required("Membership status is required"),membership_type:m.Z_().required("Membership type is required"),marital_status:m.Z_().required("Marital status is required"),anniversary_date:m.hT().nullable().required("Anniversary date is required"),profile_photo:m.nK().required("Profile picture is required"),blood_group:m.Z_().required("Blood group is required"),nationality:m.Z_().required("Nationality is required")}),en=m.Ry({member_ID:m.Z_().required("Member ID is required"),first_name:m.Z_().required("First name is required"),last_name:m.Z_(),gender:m.Z_().required("Gender is required"),date_of_birth:m.hT().required("Date of birth is required"),institute_name:m.Z_().required("Institute name is required"),batch_number:m.Z_().required("Batch number is required"),membership_status:m.Z_().required("Membership status is required"),membership_type:m.Z_().required("Membership type is required"),marital_status:m.Z_().required("Marital status is required"),anniversary_date:m.hT().nullable().required("Anniversary date is required"),profile_photo:m.nK().nullable(),blood_group:m.Z_().required("Blood group is required"),nationality:m.Z_().required("Nationality is required")});function el(){(0,C.useRouter)();let e=(0,es.e3)(),{currentStep:a,setCurrentStep:t,nextStep:r,markStepCompleted:l,setMemberID:o,memberID:d,isUpdateMode:m}=(0,w.Xm)(),h=(0,v.NL)(),{data:b,isLoading:y}=(0,j.Z)(),{data:A,isLoading:q}=(0,F.Z)(d,{enabled:m&&!!d}),{member_info:R}=A??{};console.log("memberData",R);let{membership_type:M,institute_name:B,gender:$,membership_status:V,marital_status:O}=b??{},{mutate:P,isPending:T}=(0,N.D)({mutationFn:async e=>(await _.Z.post("/api/member/v1/members/get_latest_id/",e)).data,onSuccess:e=>{if(e?.status==="success"){let a=e?.data?.next_available;a&&(K.setFieldValue("member_ID",a),o(a)),S.toast.success("Member ID added successfully")}},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response.data;t?t&&"object"==typeof t&&(Object.entries(t).forEach(([e,a])=>{Array.isArray(a)&&K.setFieldError(e,a[0])}),S.toast.error(s||a||"Generate ID Failed")):S.toast.error(s||a||"Generate ID Failed")}}),{mutate:Q,isPending:U}=(0,N.D)({mutationFn:async e=>{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{a.append(e,t)}),(await _.Z.post("/api/member/v1/members/",a,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{e?.status==="success"&&(h.invalidateQueries({queryKey:["useGetMember",d]}),S.toast.success(e.message||"Membership has been successfully added."),l(a),r())},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response.data;console.log(t),t&&"object"==typeof t?(Object.entries(t).forEach(([e,a])=>{Array.isArray(a)&&K.setFieldError(e,a[0])}),S.toast.error(a||s||"Validation failed.")):S.toast.error(s||a||"An error occurred during submission.")}}),{mutate:W,isPending:G}=(0,N.D)({mutationFn:async e=>{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{null!=t&&a.append(e,t)}),(await _.Z.patch(`/api/member/v1/members/${d}/`,a,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:e=>{e?.status==="success"&&(Promise.all([h.invalidateQueries({queryKey:["useGetMember",d]}),h.invalidateQueries({queryKey:["getAllMembers",1,2]})]),S.toast.success(e.message||"Membership Updated Successfully."))},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response.data;console.log(t),t&&"object"==typeof t?(Object.entries(t).forEach(([e,a])=>{Array.isArray(a)&&K.setFieldError(e,a[0])}),S.toast.error(a||s||"Validation failed.")):S.toast.error(s||a||"An error occurred during submission.")}}),K=(0,c.TA)({enableReinitialize:!0,initialValues:m&&R?{id:R.id,member_ID:R.member_ID||"",first_name:R.first_name||"",last_name:R.last_name||"",gender:R.gender?.name||"",date_of_birth:R.date_of_birth||null,institute_name:R.institute_name?.name||"",batch_number:R.batch_number||"",membership_status:R.membership_status?.name||"",membership_type:R.membership_type?.name||"",marital_status:R.marital_status?.name||"",anniversary_date:R.anniversary_date||null,profile_photo:null,blood_group:R.blood_group||"",nationality:R.nationality||"Bangladesh"}:{member_ID:"",first_name:"",last_name:"",gender:"",date_of_birth:null,institute_name:"",batch_number:"",membership_status:"",membership_type:"",marital_status:"",anniversary_date:null,profile_photo:null,blood_group:"",nationality:"Bangladesh"},validationSchema:m?en:er,onSubmit:e=>{m?e.id?W(e):S.toast.error("Updation ID not found"):Q(e)}});console.log(K.values);let X=(e,a)=>{K.setFieldValue(e,a);let t="membership_type"===e?K.values.institute_name:K.values.membership_type,s=a?.trim(),r=t?.trim();s&&""!==s&&r&&""!==r&&!m&&P({membership_type:"membership_type"===e?a:K.values.membership_type,institute_name:"institute_name"===e?a:K.values.institute_name})},J=(0,n.useRef)(null),Y=()=>{r()},H=()=>{K.resetForm()};return y&&q?s.jsx(L.Wo,{}):s.jsx("div",{className:"",children:(0,s.jsxs)("form",{onSubmit:K.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"member_ID",className:"text-sm font-medium text-gray-700",children:"Member ID"}),s.jsx(p.I,{id:"member_ID",name:"member_ID",disabled:!0,value:K.values.member_ID,onChange:K.handleChange,onBlur:K.handleBlur,className:"w-full",readOnly:!0}),K.touched.member_ID&&K.errors.member_ID&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.member_ID})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Membership Type"}),(0,s.jsxs)(f.Ph,{disabled:m,value:K.values.membership_type,onValueChange:e=>X("membership_type",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"Choose Membership Type"})}),s.jsx(f.Bw,{children:M?.map((e,a)=>s.jsx(f.Ql,{value:e.name,children:e.name},a))})]}),K.touched.membership_type&&K.errors.membership_type&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.membership_type})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Institute Name"}),(0,s.jsxs)(f.Ph,{disabled:m,value:K.values.institute_name,onValueChange:e=>X("institute_name",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"Choose Institute"})}),s.jsx(f.Bw,{children:B?.map((e,a)=>s.jsxs(f.Ql,{value:e.name,children:[e.name," - ",e.code]},a))})]}),K.touched.institute_name&&K.errors.institute_name&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.institute_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"first_name",className:"text-sm font-medium text-gray-700",children:"First Name"}),s.jsx(p.I,{id:"first_name",name:"first_name",value:K.values.first_name,onChange:K.handleChange,onBlur:K.handleBlur,placeholder:"Enter first name",className:"w-full"}),K.touched.first_name&&K.errors.first_name&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.first_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"last_name",className:"text-sm font-medium text-gray-700",children:"Last Name"}),s.jsx(p.I,{id:"last_name",name:"last_name",value:K.values.last_name,onChange:K.handleChange,onBlur:K.handleBlur,placeholder:"Enter last name",className:"w-full"}),K.touched.last_name&&K.errors.last_name&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.last_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Gender"}),(0,s.jsxs)(f.Ph,{value:K.values.gender,onValueChange:e=>K.setFieldValue("gender",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"Gender",children:K.values.gender?$?.find(e=>e.id==K.values.gender)?.name:"Choose Gender"})}),s.jsx(f.Bw,{children:$?.map((e,a)=>s.jsx(f.Ql,{value:e.name,children:e.name},a))})]}),K.touched.gender&&K.errors.gender&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.gender})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Profile Picture"}),s.jsx("p",{className:"text-sm text-gray-500 pr-5",children:m?R?.profile_photo?.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[s.jsx("input",{ref:J,type:"file",accept:"image/*",onChange:e=>{e.preventDefault();let a=e.target.files?.[0];a&&a&&K.setFieldValue("profile_photo",a)},className:"hidden"}),K.values.profile_photo?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsx("span",{className:"text-sm text-gray-700",children:K.values.profile_photo?K.values.profile_photo?.name:"No file chosen"}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>K.setFieldValue("profile_photo",null),children:s.jsx(z.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(x.z,{type:"button",variant:"ghost",onClick:()=>J.current?.click(),className:"w-full",children:[s.jsx(E.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),K.touched.profile_photo&&K.errors.profile_photo&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.profile_photo})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,s.jsxs)(k.J2,{children:[s.jsx(k.xo,{asChild:!0,children:(0,s.jsxs)(x.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!K.values.date_of_birth&&"text-muted-foreground"),children:[s.jsx(Z.Z,{className:"mr-2 h-4 w-4"}),K.values.date_of_birth?(0,I.WU)(K.values.date_of_birth,"PPP"):"Select Date"]})}),s.jsx(k.yk,{className:"w-auto p-0",align:"start",children:s.jsx(D.f,{mode:"single",captionLayout:"dropdown",selected:K.values.date_of_birth?new Date(K.values.date_of_birth):void 0,onSelect:e=>{if(e){let a=(0,I.WU)(e,"yyyy-MM-dd");K.setFieldValue("date_of_birth",a)}},initialFocus:!0})})]}),K.touched.date_of_birth&&K.errors.date_of_birth&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.date_of_birth})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Membership Status"}),(0,s.jsxs)(f.Ph,{value:K.values.membership_status,onValueChange:e=>K.setFieldValue("membership_status",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"What's Member Status?"})}),s.jsx(f.Bw,{children:V?.map((e,a)=>s.jsx(f.Ql,{value:e.name,children:e.name},a))})]}),K.touched.membership_status&&K.errors.membership_status&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.membership_status})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"batch_number",className:"text-sm font-medium text-gray-700",children:"Batch Number"}),s.jsx(p.I,{id:"batch_number",name:"batch_number",value:K.values.batch_number,onChange:K.handleChange,onBlur:K.handleBlur,placeholder:"Enter batch year",className:"w-full"}),K.touched.batch_number&&K.errors.batch_number&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.batch_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Marital Status"}),(0,s.jsxs)(f.Ph,{value:K.values.marital_status,onValueChange:e=>K.setFieldValue("marital_status",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"What's Marital Status?"})}),s.jsx(f.Bw,{children:O?.map((e,a)=>s.jsx(f.Ql,{value:e.name,children:e.name},a))})]}),K.touched.marital_status&&K.errors.marital_status&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.marital_status})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Anniversary Date"}),(0,s.jsxs)(k.J2,{children:[s.jsx(k.xo,{asChild:!0,children:(0,s.jsxs)(x.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!K.values.anniversary_date&&"text-muted-foreground"),children:[s.jsx(Z.Z,{className:"mr-2 h-4 w-4"}),K.values.anniversary_date?(0,I.WU)(K.values.anniversary_date,"PPP"):"Select Date"]})}),s.jsx(k.yk,{className:"w-auto p-0",align:"start",children:s.jsx(D.f,{mode:"single",captionLayout:"dropdown",selected:K.values.anniversary_date?new Date(K.values.anniversary_date):void 0,onSelect:e=>{if(e){let a=(0,I.WU)(e,"yyyy-MM-dd");K.setFieldValue("anniversary_date",a)}},initialFocus:!0})})]}),K.touched.anniversary_date&&K.errors.anniversary_date&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.anniversary_date})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Blood Group"}),(0,s.jsxs)(f.Ph,{value:K.values.blood_group,onValueChange:e=>K.setFieldValue("blood_group",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"What is his/her blood type?"})}),(0,s.jsxs)(f.Bw,{children:[s.jsx(f.Ql,{value:"A+",children:"A+"}),s.jsx(f.Ql,{value:"A-",children:"A-"}),s.jsx(f.Ql,{value:"B+",children:"B+"}),s.jsx(f.Ql,{value:"B-",children:"B-"}),s.jsx(f.Ql,{value:"AB+",children:"AB+"}),s.jsx(f.Ql,{value:"AB-",children:"AB-"}),s.jsx(f.Ql,{value:"O+",children:"O+"}),s.jsx(f.Ql,{value:"O-",children:"O-"})]})]}),K.touched.blood_group&&K.errors.blood_group&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.blood_group})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Nationality"}),(0,s.jsxs)(f.Ph,{value:K.values.nationality,onValueChange:e=>K.setFieldValue("nationality",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"Select Nationality"})}),s.jsx(f.Bw,{children:e?.map((e,a)=>s.jsx(f.Ql,{value:e,children:e},a))})]}),K.touched.nationality&&K.errors.nationality&&s.jsx("p",{className:"text-sm text-red-600",children:K.errors.nationality})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>H(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>Y(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:U||G,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[U||G?"Saving...":"Save & Next",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})})}let ei=m.Ry({data:m.IX().of(m.Ry({name:m.Z_().required("Descendant name is required"),descendant_contact_number:m.Z_().required("Contact number is required"),dob:m.hT().required("Date of birth is required"),image:m.nK().nullable().required("Profile picture is required"),relation_type:m.Z_().required("Relation type is required")})).min(1,"At least one descendant is required")}),eo=m.Ry({data:m.IX().of(m.Ry({id:m.Rx().nullable(),name:m.Z_().required("Descendant name is required"),descendant_contact_number:m.Z_().required("Contact number is required"),dob:m.hT().required("Date of birth is required"),image:m.nK().nullable().test("image-required-if-no-id","Profile picture is required",function(e){return!!this.parent.id||!!e}),relation_type:m.Z_().required("Relation type is required")})).min(1,"At least one descendant is required")});function ed(){let e=(0,n.useRef)([]);(0,C.useRouter)();let a=(0,v.NL)(),{currentStep:t,setCurrentStep:r,nextStep:l,markStepCompleted:o,memberID:d,setMemberID:m,isUpdateMode:h}=(0,w.Xm)(),{data:A,isLoading:q}=(0,F.Z)(d,{enabled:h&&!!d}),{descendant:R}=A??{},{data:M,isLoading:B}=(0,j.Z)(),{descendant_relation_choice:$}=M??{},{mutate:V,isPending:O}=(0,N.D)({mutationFn:async e=>{let a={},t=await Promise.allSettled(e.map(async(e,t)=>{try{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{t instanceof File||t instanceof Blob?a.append(e,t):"boolean"==typeof t||"number"==typeof t?a.append(e,String(t)):null!=t&&a.append(e,t)}),(await _.Z.post("/api/member/v1/members/descendants/",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){let{errors:e}=s?.response?.data||{};if(console.log(s?.response?.data),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(a[`data.${t}.${s}`]=r[0]);return null}}));Object.entries(a).forEach(([e,a])=>{Q.setFieldError(e,a)});let s=t.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(t.some(e=>"rejected"===e.status||null===e.value))throw Error("Some descendants failed to submit.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(Q.resetForm(),S.toast.success("All descendants have been successfully added."),o(t),l())},onError:e=>{console.error("Descendant submit error:",e),S.toast.error(e?.message||"Some descendants failed to submit.")}}),{mutate:P,isPending:T}=(0,N.D)({mutationFn:async e=>{let a={},t=await Promise.allSettled(e.map(async(e,t)=>{try{let a=new FormData;return Object.entries(e).forEach(([e,t])=>{t instanceof File||t instanceof Blob?a.append(e,t):"boolean"==typeof t||"number"==typeof t?a.append(e,String(t)):null!=t&&a.append(e,t)}),(await _.Z.patch("/api/member/v1/members/descendants/",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){let{errors:e}=s?.response?.data||{};if(console.log(s),e&&"object"==typeof e)for(let[s,r]of Object.entries(e))Array.isArray(r)&&r.length>0&&(a[`data.${t}.${s}`]=r[0]);return null}}));Object.entries(a).forEach(([e,a])=>{Q.setFieldError(e,a)});let s=t.map(e=>"fulfilled"===e.status?e.value:null).filter(e=>null!==e);if(t.some(e=>"rejected"===e.status||null===e.value))throw Error("Some descendants failed to update.");return s},onSuccess:e=>{Array.isArray(e)&&e.length>0&&(a.invalidateQueries({queryKey:["useGetMember",d]}),S.toast.success("All descendants updated."))},onError:e=>{console.error("Descendant update error:",e),S.toast.error(e?.message||"Some descendants failed to update.")}}),Q=(0,c.TA)({enableReinitialize:!0,initialValues:h&&R&&R?.length>0?{data:R?.map(e=>({id:e?.id||0,member_ID:d,name:e?.name||"",descendant_contact_number:e?.descendant_contact_number||"",dob:e?.dob||null,image:null,relation_type:e?.relation_type?.id?.toString()||""}))}:{data:[{member_ID:d,name:"",descendant_contact_number:"",dob:null,image:null,relation_type:""}]},validationSchema:h?eo:ei,onSubmit:e=>{if(!d){S.toast.error("No Member ID found.");return}h?P(e.data):V(e.data)}}),L=e=>{if(Q.values.data.length>1){let a=Q.values.data.filter((a,t)=>t!==e);Q.setFieldValue("data",a)}else S.toast.error("Cannot remove descendant - at least one descendant is required")},U=(e,a,t)=>{Q.setFieldValue(`data.${e}.${a}`,t)},W=(e,a)=>{let t=a.target.files?.[0];t?U(e,"image",t):S.toast.error("No file selected")},G=()=>{l()},K=()=>{Q.resetForm()};return(0,s.jsxs)("form",{onSubmit:Q.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[Q.values.data.map((a,t)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[Q.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Descendant ",t+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>L(t),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Descendant Name"}),s.jsx(p.I,{placeholder:"Enter Descendant Name",value:a.name,onChange:e=>U(t,"name",e.target.value),onBlur:Q.handleBlur,name:`data.${t}.name`,className:"w-full"}),Q.touched.data?.[t]?.name&&Q.errors.data?.[t]?.name&&s.jsx("p",{className:"text-sm text-red-600",children:Q.errors.data?.[t]?.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Contact Number"}),s.jsx(p.I,{type:"tel",placeholder:"Enter Descendant Contact",value:a.descendant_contact_number,onChange:e=>U(t,"descendant_contact_number",e.target.value),onBlur:Q.handleBlur,name:`data.${t}.descendant_contact_number`,className:"w-full"}),Q.touched.data?.[t]?.descendant_contact_number&&Q.errors.data?.[t]?.descendant_contact_number&&s.jsx("p",{className:"text-sm text-red-600",children:Q.errors.data?.[t]?.descendant_contact_number})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,s.jsxs)(k.J2,{children:[s.jsx(k.xo,{asChild:!0,children:(0,s.jsxs)(x.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!a.dob&&"text-muted-foreground"),children:[s.jsx(Z.Z,{className:"mr-2 h-4 w-4"}),a.dob?(0,I.WU)(a.dob,"PPP"):"Select Date"]})}),s.jsx(k.yk,{className:"w-auto p-0",align:"start",children:s.jsx(D.f,{mode:"single",captionLayout:"dropdown",selected:a.dob?new Date(a.dob):void 0,onSelect:e=>{e&&U(t,"dob",(0,I.WU)(e,"yyyy-MM-dd"))},initialFocus:!0})})]}),Q.touched.data?.[t]?.dob&&Q.errors.data?.[t]?.dob&&s.jsx("p",{className:"text-sm text-red-600",children:Q.errors.data?.[t]?.dob})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Descendant Picture"}),s.jsx("p",{className:"text-sm text-gray-500 pr-5",children:h?R[t]?.image?.split("/").pop():null})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[s.jsx("input",{ref:a=>{e.current[t]=a},type:"file",accept:"image/*",onChange:e=>W(t,e),className:"hidden"}),a.image?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsx("span",{className:"text-sm text-gray-700",children:a.image.name}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{U(t,"image",null)},children:s.jsx(z.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)(x.z,{type:"button",variant:"ghost",onClick:()=>{e.current[t]?.click()},className:"w-full",children:[s.jsx(E.Z,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),Q.touched.data?.[t]?.image&&Q.errors.data?.[t]?.image&&s.jsx("p",{className:"text-sm text-red-600",children:Q.errors.data?.[t]?.image})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Relation Type"}),(0,s.jsxs)(f.Ph,{value:a.relation_type,onValueChange:e=>U(t,"relation_type",e),children:[s.jsx(f.i4,{className:"w-full",children:s.jsx(f.ki,{placeholder:"What is the Relation with Member?",children:$?.find(e=>String(e.id)===String(Q.values.data[t].relation_type))?.name})}),s.jsx(f.Bw,{children:$?.map(e=>s.jsx(f.Ql,{value:e.id,children:e.name},e.id))})]}),Q.touched.data?.[t]?.relation_type&&Q.errors.data?.[t]?.relation_type&&s.jsx("p",{className:"text-sm text-red-600",children:Q.errors.data?.[t]?.relation_type})]})]})]},t)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...Q.values.data,{member_ID:d,name:"",descendant_contact_number:"",dob:null,image:null,relation_type:""}];Q.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>K(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>G(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:O||T,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[O||T?"Saving...":"Save & Next"," ",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let ec=m.Ry({data:m.IX().of(m.Ry({title:m.Z_().required("Special day title is required"),date:m.hT().required("Special day date is required")})).min(1,"At least one special day is required")}),em={data:[{title:"",date:null}]};function eu(){(0,C.useRouter)();let e=(0,v.NL)(),{currentStep:a,setCurrentStep:t,nextStep:r,markStepCompleted:n,memberID:l,setMemberID:o,isUpdateMode:d}=(0,w.Xm)(),{data:m,isLoading:h}=(0,F.Z)(l,{enabled:d&&!!l}),{special_days:f}=m??{},{mutate:j,isPending:A}=(0,N.D)({mutationFn:async e=>(await _.Z.post("/api/member/v1/members/special_day/",e)).data,onSuccess:e=>{e?.status==="success"&&(E.resetForm(),S.toast.success(e.message||"Special day has been successfully added."),n(a),r())},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;E.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),{mutate:q,isPending:z}=(0,N.D)({mutationFn:async e=>(await _.Z.patch(`/api/member/v1/members/special_day/${l}`,e)).data,onSuccess:a=>{a?.status==="success"&&(e.invalidateQueries({queryKey:["useGetMember",l]}),S.toast.success(a.message||"Special day successfully updated."))},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;E.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),E=(0,c.TA)({enableReinitialize:!0,initialValues:d&&f&&f?.length>0?{data:f?.map(e=>({id:e.id||0,title:e.title||"",date:e.date?new Date(e.date):null}))}:em,validationSchema:ec,onSubmit:e=>{if(!l){S.toast.error("No Member ID found.");return}let a={member_ID:l,data:e.data};d?q(a):j(a)}}),R=e=>{if(E.values.data.length>1){let a=E.values.data.filter((a,t)=>t!==e);E.setFieldValue("data",a)}else S.toast.error("At least one special day is required")},M=(e,a,t)=>{E.setFieldValue(`data.${e}.${a}`,t)},B=()=>{r()},$=()=>{E.resetForm()};return(0,s.jsxs)("form",{onSubmit:E.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[E.values.data.map((e,a)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[E.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Special Day ",a+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(a),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Special Day Title"}),s.jsx(p.I,{placeholder:"Special Day Name",value:e.title,onChange:e=>M(a,"title",e.target.value),onBlur:E.handleBlur,name:`data.${a}.title`,className:"w-full"}),E.touched.data?.[a]?.title&&E.errors.data?.[a]?.title&&s.jsx("p",{className:"text-sm text-red-600",children:E.errors.data?.[a]?.title})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Select Special Day"}),(0,s.jsxs)(k.J2,{children:[s.jsx(k.xo,{asChild:!0,children:(0,s.jsxs)(x.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!e.date&&"text-muted-foreground"),children:[s.jsx(Z.Z,{className:"mr-2 h-4 w-4"}),e.date?(0,I.WU)(e.date,"PPP"):"Choose date"]})}),s.jsx(k.yk,{className:"w-auto p-0",align:"start",children:s.jsx(D.f,{mode:"single",captionLayout:"dropdown",selected:E.values.data[a].date?new Date(E.values.data[a].date):void 0,onSelect:e=>{e&&M(a,"date",(0,I.WU)(e,"yyyy-MM-dd"))},initialFocus:!0})})]}),E.touched.data?.[a]?.date&&E.errors.data?.[a]?.date&&s.jsx("p",{className:"text-sm text-red-600",children:E.errors.data?.[a]?.date})]})]})]},a)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...E.values.data,{title:"",date:null}];E.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>$(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>B(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:A||z,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[A||z?"Saving...":"Save & Next",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}let ep=m.Ry({data:m.IX().of(m.Ry({title:m.Z_().required("Job title is required"),organization_name:m.Z_().required("Organization name is required"),location:m.Z_().required("Location is required")})).min(1,"At least one job detail is required")}),eh={data:[{title:"",organization_name:"",location:""}]};function ex(){(0,C.useRouter)();let e=(0,v.NL)(),{currentStep:a,setCurrentStep:t,nextStep:r,markStepCompleted:n,memberID:l,setMemberID:i,isUpdateMode:o}=(0,w.Xm)(),{data:d,isLoading:m}=(0,F.Z)(l,{enabled:o&&!!l}),{job:h}=d??{},{mutate:f,isPending:j}=(0,N.D)({mutationFn:async e=>(await _.Z.post("/api/member/v1/members/job/",e)).data,onSuccess:e=>{e?.status==="success"&&(D.resetForm(),S.toast.success(e.message||"Job Detail has been added."),n(a),r())},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;D.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),{mutate:A,isPending:q}=(0,N.D)({mutationFn:async e=>(await _.Z.patch(`/api/member/v1/members/job/${l}`,e)).data,onSuccess:a=>{a?.status==="success"&&(e.invalidateQueries({queryKey:["useGetMember",l]}),S.toast.success(a.message||"Job Detail has been successfully updated."))},onError:e=>{console.log("error",e?.response);let{message:a,errors:t,detail:s}=e?.response?.data||{};if(t?.data&&Array.isArray(t.data)&&t.data.forEach((e,a)=>{if(e&&"object"==typeof e){for(let[t,s]of Object.entries(e))if(Array.isArray(s)&&s.length>0){let e=`data.${a}.${t}`;D.setFieldError(e,s[0])}}}),t&&"object"==typeof t){let e=Object.keys(t).filter(e=>"data"!==e);if(e.length>0){let a=t[e[0]];if(Array.isArray(a)&&a.length>0){S.toast.error(a[0]);return}}}S.toast.error(s||a||"Submission Failed")}}),D=(0,c.TA)({enableReinitialize:!0,initialValues:o&&h&&h?.length>0?{data:h?.map(e=>({id:e?.id||0,title:e?.title||"",organization_name:e?.organization_name||"",location:e?.location||""}))}:eh,validationSchema:ep,onSubmit:e=>{if(!l){S.toast.error("No Member ID found.");return}let a={member_ID:l,data:e.data};o?A(a):f(a)}}),k=e=>{if(D.values.data.length>1){let a=D.values.data.filter((a,t)=>t!==e);D.setFieldValue("data",a)}else S.toast.error("At least one job detail is required")},Z=(e,a,t)=>{D.setFieldValue(`data.${e}.${a}`,t)},z=()=>{r()},E=()=>{D.resetForm()};return(0,s.jsxs)("form",{onSubmit:D.handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[D.values.data.map((e,a)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 relative",children:[D.values.data.length>1&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900",children:["Job Detail ",a+1]}),s.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(a),className:"text-red-600 hover:text-red-700",children:s.jsx(b.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Job Title"}),s.jsx(p.I,{placeholder:"Enter Job Title",value:e.title,onChange:e=>Z(a,"title",e.target.value),onBlur:D.handleBlur,name:`data.${a}.title`,className:"w-full"}),D.touched.data?.[a]?.title&&D.errors.data?.[a]?.title&&s.jsx("p",{className:"text-sm text-red-600",children:D.errors.data?.[a]?.title})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Organization Name"}),s.jsx(p.I,{placeholder:"Enter Organization Name",value:e.organization_name,onChange:e=>Z(a,"organization_name",e.target.value),onBlur:D.handleBlur,name:`data.${a}.organization_name`,className:"w-full"}),D.touched.data?.[a]?.organization_name&&D.errors.data?.[a]?.organization_name&&s.jsx("p",{className:"text-sm text-red-600",children:D.errors.data?.[a]?.organization_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-sm font-medium text-gray-700",children:"Location"}),s.jsx(p.I,{placeholder:"Enter Location",value:e.location,onChange:e=>Z(a,"location",e.target.value),onBlur:D.handleBlur,name:`data.${a}.location`,className:"w-full"}),D.touched.data?.[a]?.location&&D.errors.data?.[a]?.location&&s.jsx("p",{className:"text-sm text-red-600",children:D.errors.data?.[a]?.location})]})]})]},a)),s.jsx("div",{children:(0,s.jsxs)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...D.values.data,{title:"",organization_name:"",location:""}];D.setFieldValue("data",e)},className:"gap-2 bg-transparent",children:[s.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"Add Another"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1",children:[s.jsx(x.z,{type:"button",variant:"outline",onClick:()=>E(),className:"flex-1 sm:flex-none bg-transparent",children:"Reset"}),s.jsx(x.z,{type:"button",variant:"ghost",onClick:()=>z(),className:"flex-1 sm:flex-none",children:"Skip"})]}),(0,s.jsxs)(x.z,{type:"submit",disabled:j||q,className:"bg-black hover:bg-gray-800 text-white flex-1 sm:flex-none sm:min-w-[140px]",children:[j||q?"Saving...":"Save & Next",s.jsx(g.Z,{className:"w-4 h-4 ml-2"})]})]})]})}var ef=t(39313);let eb=ef.zt,ey=ef.fC,eg=ef.xz,ej=n.forwardRef(({className:e,sideOffset:a=4,...t},r)=>s.jsx(ef.h_,{children:s.jsx(ef.VY,{ref:r,sideOffset:a,className:(0,i.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...t})}));ej.displayName=ef.VY.displayName;let e_=[{full:"Membership Details",short:"Membership"},{full:"Member Contact Details",short:"Contact"},{full:"Member Emails Details",short:"Email"},{full:"Member Address Details",short:"Address"},{full:"Member Spouse Details",short:"Spouse"},{full:"Member Descendants Details",short:"Descendants"},{full:"Member Companion Details",short:"Companion"},{full:"Member Emergency Contact Details",short:"Emergency"},{full:"Member Documents Details",short:"Documents"},{full:"Member Certificate Details",short:"Certificate"},{full:"Member Job Details",short:"Job"},{full:"Member Special Days",short:"Special Days"}];function ev(){let{currentStep:e,completedSteps:a,totalSteps:t,memberID:n,setCurrentStep:l,setMemberID:i,setIsUpdateMode:c,resetSteps:m}=(0,w.Xm)(),u=(0,C.usePathname)(),p=u?.startsWith("/member/update/"),h=e=>{l(e)},x=(e+1)/t*100;return s.jsx("div",{className:"text-foreground",children:(0,s.jsxs)("div",{className:"mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h1",{className:"text-2xl font-bold",children:p?(0,s.jsxs)("p",{children:["Update Member"," ",s.jsx("span",{className:"font-secondary text-lg text-sky-500",children:n&&"#"+n})]}):(0,s.jsxs)("p",{children:["Add New Member"," ",s.jsx("span",{className:"font-secondary text-lg text-sky-500",children:n&&"#"+n})]})}),(0,s.jsxs)(d.C,{variant:"secondary",className:"text-sm",children:["Step ",e+1," of ",t]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:e_[e].full}),(0,s.jsxs)("span",{children:[Math.round(x),"% Complete"]})]}),s.jsx(o,{value:x,className:"h-2"})]}),s.jsx("div",{className:"flex justify-between mt-4 overflow-x-auto",children:s.jsx(eb,{children:e_.map((t,r)=>(0,s.jsxs)("div",{className:`flex flex-col items-center space-y-1 min-w-0 flex-1 cursor-pointer transition-colors ${r<=e?"text-primary":"text-gray-400"}`,onClick:()=>h(r),children:[(0,s.jsxs)(ey,{children:[s.jsx(eg,{asChild:!0,children:s.jsx("div",{className:`w-7 h-7 md:w-8 md:h-8 rounded-full flex items-center justify-center text-xs font-medium transition-colors ${a.includes(r)?"bg-green-500 text-white":r===e?"bg-primary text-primary-foreground":"bg-gray-200 text-gray-500 hover:bg-gray-300"}`,children:a.includes(r)?"":r+1})}),s.jsx(ej,{children:s.jsx("p",{children:t.full})})]}),s.jsx("span",{className:"hidden sm:block text-xs text-center truncate w-full px-1",children:t.short})]},r))})})]}),(0,s.jsxs)(r.Zb,{className:"shadow-lg",children:[s.jsx(r.Ol,{className:"pb-4",children:s.jsx(r.ll,{className:"text-xl text-primary",children:e_[e].full})}),s.jsx(r.aY,{children:s.jsx("div",{className:"space-y-6",children:[s.jsx(el,{},"membership"),s.jsx(q,{},"contact"),s.jsx(G,{},"email"),s.jsx(Y,{},"address"),s.jsx(et,{},"spouse"),s.jsx(ed,{},"descendants"),s.jsx(M,{},"companion"),s.jsx(V,{},"emergency"),s.jsx(Q,{},"document"),s.jsx(P,{},"certificate"),s.jsx(ex,{},"job"),s.jsx(eu,{},"special-days")][e]})})]})]})})}},38443:(e,a,t)=>{t.d(a,{C:()=>i});var s=t(10326);t(17577);var r=t(79360),n=t(51223);let l=(0,r.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:a,...t}){return s.jsx("div",{className:(0,n.cn)(l({variant:a}),e),...t})}},33194:(e,a,t)=>{t.d(a,{f:()=>c});var s=t(10326),r=t(17577),n=t(65249),l=t(91664),i=t(3236),o=t(29280),d=t(51223);function c({className:e,classNames:a,hideNavigation:t,showOutsideDays:c=!0,components:m,...u}){let p=(0,d.cn)("relative flex flex-col gap-4 sm:flex-row",u.monthsClassName),h=(0,d.cn)("relative flex h-7 items-center justify-center",u.monthCaptionClassName),x=(0,d.cn)("flex items-center justify-center gap-2 w-full",t?"w-full":"",u.dropdownsClassName),f=(0,d.cn)("pt-3 text-sm",u.footerClassName),b=(0,d.cn)("flex",u.weekdaysClassName),y=(0,d.cn)("w-9 text-sm font-normal text-muted-foreground",u.weekdayClassName),g=(0,d.cn)("truncate text-sm font-medium",u.captionLabelClassName),j=(0,d.cn)("mx-auto mt-4",u.monthGridClassName),_=(0,d.cn)("mt-2 flex w-max items-start",u.weekClassName),v=(0,d.cn)("flex size-9 flex-1 items-center justify-center p-0 text-sm",u.dayClassName),N=(0,d.cn)((0,l.d)({variant:"ghost"}),"size-9 rounded-md p-0 font-normal transition-none aria-selected:opacity-100",u.dayButtonClassName),w="bg-accent [&>button]:bg-primary [&>button]:text-primary-foreground [&>button]:hover:bg-primary [&>button]:hover:text-primary-foreground",C=(0,d.cn)(w,"rounded-s-md",u.rangeStartClassName),S=(0,d.cn)(w,"rounded-e-md",u.rangeEndClassName),F=(0,d.cn)("bg-accent !text-foreground [&>button]:bg-transparent [&>button]:!text-foreground [&>button]:hover:bg-transparent [&>button]:hover:!text-foreground",u.rangeMiddleClassName),A=(0,d.cn)("[&>button]:bg-primary [&>button]:text-primary-foreground [&>button]:hover:bg-primary [&>button]:hover:text-primary-foreground",u.selectedClassName),q=(0,d.cn)("[&>button]:bg-accent [&>button]:text-accent-foreground",u.todayClassName),D=(0,d.cn)("text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",u.outsideClassName),k=(0,d.cn)("text-muted-foreground opacity-50",u.disabledClassName),Z=(0,d.cn)("invisible flex-1",u.hiddenClassName),z=r.useCallback(({value:e,onChange:a,options:t})=>{let r=t?.find(a=>a.value===e),n=e=>{a?.({target:{value:e}})};return(0,s.jsxs)(o.Ph,{value:e?.toString(),onValueChange:e=>{n(e)},children:[s.jsx(o.i4,{className:"outline-none focus:ring-0 focus:ring-offset-0",children:s.jsx(o.ki,{children:r?.label})}),s.jsx(o.Bw,{position:"popper",align:"center",children:s.jsx(i.ScrollArea,{className:"h-80",children:t?.map(({value:e,label:a,disabled:t},r)=>s.jsx(o.Ql,{value:e?.toString(),disabled:t,children:a},`${e}-${r}`))})})]})},[]);return s.jsx(n._,{showOutsideDays:c,hideNavigation:!0,className:(0,d.cn)("p-3",e),classNames:{caption_label:g,day:v,day_button:N,dropdowns:x,footer:f,month:u.monthClassName,month_caption:h,month_grid:j,months:p,week:_,weekday:y,weekdays:b,range_end:S,range_middle:F,range_start:C,selected:A,disabled:k,hidden:Z,outside:D,today:q,nav:"hidden",...a},components:{Dropdown:z,...m},...u})}c.displayName="Calendar"},29752:(e,a,t)=>{t.d(a,{Ol:()=>i,SZ:()=>d,Zb:()=>l,aY:()=>c,eW:()=>m,ll:()=>o});var s=t(10326),r=t(17577),n=t(51223);let l=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...a}));l.displayName="Card";let i=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let o=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",e),...a}));o.displayName="CardTitle";let d=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...a}));d.displayName="CardDescription";let c=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("p-6 pt-0",e),...a}));c.displayName="CardContent";let m=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",e),...a}));m.displayName="CardFooter"},41190:(e,a,t)=>{t.d(a,{I:()=>l});var s=t(10326),r=t(17577),n=t(51223);let l=r.forwardRef(({className:e,type:a,...t},r)=>s.jsx("input",{type:a,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));l.displayName="Input"},44794:(e,a,t)=>{t.d(a,{_:()=>d});var s=t(10326),r=t(17577),n=t(34478),l=t(79360),i=t(51223);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef(({className:e,...a},t)=>s.jsx(n.f,{ref:t,className:(0,i.cn)(o(),e),...a}));d.displayName=n.f.displayName},51027:(e,a,t)=>{t.d(a,{J2:()=>i,xo:()=>o,yk:()=>d});var s=t(10326),r=t(17577),n=t(74964),l=t(51223);let i=n.fC,o=n.xz;n.ee;let d=r.forwardRef(({className:e,align:a="center",sideOffset:t=4,...r},i)=>s.jsx(n.h_,{children:s.jsx(n.VY,{ref:i,align:a,sideOffset:t,className:(0,l.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e),...r})}));d.displayName=n.VY.displayName},29280:(e,a,t)=>{t.d(a,{Bw:()=>x,Ph:()=>c,Ql:()=>f,i4:()=>u,ki:()=>m});var s=t(10326),r=t(17577),n=t(44875),l=t(941),i=t(96633),o=t(32933),d=t(51223);let c=n.fC;n.ZA;let m=n.B4,u=r.forwardRef(({className:e,children:a,...t},r)=>(0,s.jsxs)(n.xz,{ref:r,className:(0,d.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[a,s.jsx(n.JO,{asChild:!0,children:s.jsx(l.Z,{className:"h-4 w-4 opacity-50"})})]}));u.displayName=n.xz.displayName;let p=r.forwardRef(({className:e,...a},t)=>s.jsx(n.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:s.jsx(i.Z,{className:"h-4 w-4"})}));p.displayName=n.u_.displayName;let h=r.forwardRef(({className:e,...a},t)=>s.jsx(n.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:s.jsx(l.Z,{className:"h-4 w-4"})}));h.displayName=n.$G.displayName;let x=r.forwardRef(({className:e,children:a,position:t="popper",...r},l)=>s.jsx(n.h_,{children:(0,s.jsxs)(n.VY,{ref:l,className:(0,d.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...r,children:[s.jsx(p,{}),s.jsx(n.l_,{className:(0,d.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),s.jsx(h,{})]})}));x.displayName=n.VY.displayName,r.forwardRef(({className:e,...a},t)=>s.jsx(n.__,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",e),...a})).displayName=n.__.displayName;let f=r.forwardRef(({className:e,children:a,...t},r)=>(0,s.jsxs)(n.ck,{ref:r,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[s.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(n.wU,{children:s.jsx(o.Z,{className:"h-4 w-4"})})}),s.jsx(n.eT,{children:a})]}));f.displayName=n.ck.displayName,r.forwardRef(({className:e,...a},t)=>s.jsx(n.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...a})).displayName=n.Z0.displayName},73326:(e,a,t)=>{t.d(a,{r:()=>i});var s=t(10326),r=t(17577),n=t(41959),l=t(51223);let i=r.forwardRef(({className:e,...a},t)=>s.jsx(n.fC,{className:(0,l.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...a,ref:t,children:s.jsx(n.bU,{className:(0,l.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));i.displayName=n.fC.displayName},82015:(e,a,t)=>{t.d(a,{g:()=>l});var s=t(10326),r=t(17577),n=t(51223);let l=r.forwardRef(({className:e,...a},t)=>s.jsx("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:t,...a}));l.displayName="Textarea"},59395:(e,a,t)=>{t.d(a,{Z:()=>l});var s=t(47769),r=t(20108),n=t(11439);let l=function(){return(0,r.a)({queryKey:["getAllChoice"],queryFn:async()=>{try{let e=await s.Z.get("/api/core/v1/all_choices/?cache=false");if(e?.data?.status=="success")return e.data.data;return console.error("Failed to fetch Choices:",e.data.message),[]}catch(e){return console.error("Error fetching Choices stats:",e),n.toast.error("Error fetching Choices"),[]}}})}},54462:(e,a,t)=>{t.d(a,{Z:()=>l});var s=t(47769),r=t(20108),n=t(11439);let l=function(e,a={}){return(0,r.a)({queryKey:["useGetMember",e],queryFn:async()=>{try{let a=await s.Z.get(`/api/member/v1/members/${e}/`);if(a?.data?.status=="success")return a.data?.data;return console.error("Failed to fetch :",a.data.message),n.toast.error(a.data.message||"Failed to fetch Member"),[]}catch(e){return console.error("Error fetching : ",e),n.toast.error(e?.response?.data?.message||"Failed to fetch Member"),[]}},enabled:!!e,...a})}},59002:(e,a,t)=>{t.d(a,{JC:()=>n,Xm:()=>i,de:()=>l});var s=t(68408),r=t(85251);(0,s.U)()((0,r.tJ)((e,a,t)=>({username:"",setUsername:a=>e({username:a}),clearUsername:()=>{e({username:""}),t.persist.clearStorage()}}),{name:"user-storage"})),(0,s.U)()(e=>({step:1,email:"",otp:"",userInfo:{name:"",password:""},error:"",setEmail:a=>e({email:a}),setOtp:a=>e({otp:a}),setUserInfo:a=>e({}),setError:a=>e({error:a}),nextStep:()=>e(e=>({step:e.step+1})),prevStep:()=>e(e=>({step:e.step-1}))})),(0,s.U)()((0,r.tJ)((e,a)=>({step:1,error:"",setError:a=>e(e=>({error:a})),nextStep:()=>e(e=>({step:e.step+1})),prevStep:()=>e(e=>({step:e.step-1}))}),{name:"member-store",partialize:e=>({step:e.step})})),(0,s.U)()((0,r.tJ)(e=>({token:"",setToken:a=>e({token:a})}),{name:"forget-token-store"}));let n=(0,s.U)((e,a)=>({email:"",otp:"",token:"",setEmail:a=>e({email:a}),setOtp:a=>e({otp:a}),setToken:a=>e({token:a}),reset:()=>e({email:"",otp:"",token:""})})),l=(0,s.U)((e,a)=>({email:"",isOtpPass:!1,setEmail:a=>e({email:a}),setOtpPass:a=>e({isOtpPass:a}),reset:()=>e({email:"",isOtpPass:!1})})),i=(0,s.U)((e,a)=>({currentStep:0,completedSteps:[],totalSteps:12,memberID:"",isUpdateMode:!1,setMemberID:a=>e({memberID:a}),setIsUpdateMode:a=>e({isUpdateMode:a}),setCurrentStep:t=>{let{totalSteps:s}=a();t>=0&&t<s&&e({currentStep:t})},nextStep:()=>{let{currentStep:t,totalSteps:s}=a();t<s-1&&e({currentStep:t+1})},prevStep:()=>{let{currentStep:t}=a();t>0&&e({currentStep:t-1})},markStepCompleted:t=>{let{completedSteps:s}=a();s.includes(t)||e({completedSteps:[...s,t]})},resetSteps:()=>{e({currentStep:0,completedSteps:[]})}}))},32562:(e,a,t)=>{t.d(a,{Z:()=>s});let s=(0,t(68570).createProxy)(String.raw`A:\peopleForTek\member management backend\Member-Management-Nextjs\src\components\member-pages\AddMember.tsx#default`)}};